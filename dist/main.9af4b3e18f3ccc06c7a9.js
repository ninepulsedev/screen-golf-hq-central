"use strict";(self.webpackChunkscreen_golf_admin=self.webpackChunkscreen_golf_admin||[]).push([[792],{800(e,t,r){var n=r(4848),s=r(6540),a=r(5338),o=r(5570),l=r(9916),i=r(22),c=(0,r(223).Wp)({apiKey:"AIzaSyCg8y5huPb-KiuqWWFZlbQqQq0HOubJhr0",authDomain:"screen-golf-hq-central.firebaseapp.com",projectId:"screen-golf-hq-central",storageBucket:"screen-golf-hq-central.firebasestorage.app",messagingSenderId:"824852063284",appId:"1:824852063284:web:f92661e3a19c7d83d39661"}),u=(0,l.xI)(c),d=(0,i.aU)(c),m={대한민국:"+82",한국:"+82",북한:"+850",일본:"+81",중국:"+86",홍콩:"+852",마카오:"+853",타이완:"+886",몽골:"+976",싱가포르:"+65",말레이시아:"+60",태국:"+66",베트남:"+84",필리핀:"+63",인도네시아:"+62",미얀마:"+95",캄보디아:"+855",라오스:"+856",브루나이:"+673",동티모르:"+670",인도:"+91",파키스탄:"+92",방글라데시:"+880",스리랑카:"+94",네팔:"+977",부탄:"+975",몰디브:"+960",아프가니스탄:"+93",영국:"+44",아일랜드:"+353",프랑스:"+33",독일:"+49",이탈리아:"+39",스페인:"+34",포르투갈:"+351",네덜란드:"+31",벨기에:"+32",룩셈부르크:"+352",오스트리아:"+43",스위스:"+41",스웨덴:"+46",노르웨이:"+47",덴마크:"+45",핀란드:"+358",폴란드:"+48",체코:"+420",헝가리:"+36",슬로바키아:"+421",슬로베니아:"+386",크로아티아:"+385","보스니아 헤르체고비나":"+387",세르비아:"+381",몬테네그로:"+382",알바니아:"+355",북마케도니아:"+389",그리스:"+30",터키:"+90",불가리아:"+359",루마니아:"+40",에스토니아:"+372",라트비아:"+371",리투아니아:"+370",벨라루스:"+375",우크라이나:"+380",몰도바:"+373",러시아:"+7",조지아:"+995",아르메니아:"+374",아제르바이잔:"+994",키프로스:"+357",몰타:"+356",아이슬란드:"+354",미국:"+1",캐나다:"+1",멕시코:"+52",브라질:"+55",아르헨티나:"+54",칠레:"+56",페루:"+51",콜롬비아:"+57",베네수엘라:"+58",에콰도르:"+593",볼리비아:"+591",파라과이:"+595",우루과이:"+598",가이아나:"+592",수리남:"+597",코스타리카:"+506",파나마:"+507",과테말라:"+502",벨리즈:"+501",엘살바도르:"+503",온두라스:"+504",니카라과:"+505",쿠바:"+53",자메이카:"+1876",아이티:"+509","도미니카 공화국":"+1809",바하마:"+1242",바베이도스:"+1246","트리니다드 토바고":"+1868",이집트:"+20",나이지리아:"+234",남아프리카:"+27",케냐:"+254",탄자니아:"+255",우간다:"+256",르완다:"+250",부룬디:"+257",에티오피아:"+251",수단:"+249",리비아:"+218",튀니지:"+216",알제리:"+213",모로코:"+212",가나:"+233",코트디부아르:"+225",세네갈:"+221",말리:"+223",부르키나파소:"+226",니제르:"+227",차드:"+235",중앙아프리카:"+236",카메룬:"+237",적도기니:"+240",가봉:"+241",콩고:"+242","콩고 민주 공화국":"+243",앙골라:"+244",잠비아:"+260",말라위:"+265",모잠비크:"+258",짐바브웨:"+263",보츠와나:"+267",나미비아:"+264",레소토:"+266",에스와티니:"+268",세이셸:"+248",모리셔스:"+230",마다가스카르:"+261",코모로:"+269",카보베르데:"+238",기니비사우:"+245",기니:"+224",시에라리온:"+232",라이베리아:"+231",토고:"+228",베냉:"+229",호주:"+61",뉴질랜드:"+64",피지:"+679",파푸아뉴기니:"+675","솔로몬 제도":"+677",바누아투:"+678",사모아:"+685",통가:"+676",키리바시:"+686",나우루:"+674",투발루:"+688",팔라우:"+680","마셜 제도":"+692",미크로네시아:"+691",사우디아라비아:"+966",아랍에미리트:"+971",카타르:"+974",쿠웨이트:"+965",바레인:"+973",오만:"+968",예멘:"+967",요르단:"+962",레바논:"+961",시리아:"+963",이라크:"+964",이란:"+98",이스라엘:"+972",바티칸:"+379",산마리노:"+378",모나코:"+377",안도라:"+376",리히텐슈타인:"+423"},x=function(e){return e.trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9가-힣]/g,"")},h=function(e){return e.replace(/[@.]/g,"_")},f=function(e){if(!e)return"KR";if(2===e.length&&/^[A-Z]{2}$/.test(e.toUpperCase()))return e.toUpperCase();var t=e.toUpperCase(),r={대한민국:"KR",한국:"KR",KOREA:"KR","UNITED STATES":"US",USA:"US",미국:"US",JAPAN:"JP",일본:"JP",CHINA:"CN",중국:"CN","UNITED KINGDOM":"GB",UK:"GB",영국:"GB"};if(r[t])return r[t];for(var n=0,s=Object.entries(m);n<s.length;n++){var a=s[n],o=a[0],l=a[1];if(o.toUpperCase()===t)return{"+82":"KR","+1":"US","+81":"JP","+86":"CN","+44":"GB","+49":"DE","+33":"FR","+39":"IT","+34":"ES","+31":"NL","+46":"SE","+47":"NO","+45":"DK","+41":"CH","+43":"AT","+358":"FI"}[l]||"KR"}return"KR"},p=function(e){var t;if(!e)return"KR";var r=null===(t=e.split("@")[1])||void 0===t?void 0:t.toLowerCase();if(!r)return"KR";var n={"daum.net":"KR","naver.com":"KR","hanmail.net":"KR","nate.com":"KR","paran.com":"KR","korea.com":"KR","dreamwiz.com":"KR","chol.com":"KR","hanafos.com":"KR","gmail.com":"US","yahoo.com":"US","hotmail.com":"US","outlook.com":"US","aol.com":"US","icloud.com":"US","mail.com":"US","zoho.com":"US","qq.com":"CN","163.com":"CN","126.com":"CN","sina.com":"CN","sohu.com":"CN","yahoo.co.jp":"JP","gmail.co.jp":"JP","yahoo.co.uk":"GB","gmail.co.uk":"GB","web.de":"DE","gmx.de":"DE","libero.it":"IT","virgilio.it":"IT","yahoo.fr":"FR","gmail.fr":"FR","yahoo.es":"ES","gmail.es":"ES"};if(n[r])return n[r];var s={"co.kr":"KR",kr:"KR",com:"US",org:"US",net:"US",edu:"US",gov:"US","co.jp":"JP",jp:"JP","co.cn":"CN",cn:"CN","co.uk":"GB",uk:"GB",ca:"CA",au:"AU",de:"DE",fr:"FR",it:"IT",es:"ES",nl:"NL"};if(s[r])return s[r];for(var a=0,o=Object.entries(s);a<o.length;a++){var l=o[a],i=l[0],c=l[1];if(r.includes(i))return c}return"KR"},g=function(e){return"users_".concat(e||"KR")},y=function(e){return"movare00@gmail.com"===e},v=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},b=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},j=function(e){return v(void 0,void 0,void 0,function(){var t,r,n,s,a,o,l;return b(this,function(c){switch(c.label){case 0:console.log("🔍 AuthContext: 매장 데이터 조회 시작:",e),t=0,r=["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],c.label=1;case 1:if(!(t<r.length))return[3,6];n=r[t],c.label=2;case 2:return c.trys.push([2,4,,5]),s=(0,i.H9)(d,"users_".concat(n),e),[4,(0,i.x7)(s)];case 3:return(a=c.sent()).exists()?(o=a.data(),console.log("✅ AuthContext: ".concat(n,"에서 매장 데이터 찾음:"),{email:o.email,storeName:o.storeName,countryCode:o.countryCode,country:o.country,role:o.role}),[2,{uid:o.uid,email:o.email,displayName:o.displayName,role:o.role,storeName:o.storeName,countryCode:o.countryCode,country:o.country,region:o.region,city:o.city,extraEmail:o.extraEmail,storeId:o.storeId}]):[3,5];case 4:return l=c.sent(),console.error("❌ AuthContext: ".concat(n," 조회 오류:"),l),[3,5];case 5:return t++,[3,1];case 6:return console.error("❌ AuthContext: 매장 데이터를 찾을 수 없음:",e),[2,null]}})})},N=(0,s.createContext)(void 0),w=function(){var e=(0,s.useContext)(N);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},C=function(e){var t=e.children,r=(0,s.useState)(null),a=r[0],o=r[1],i=(0,s.useState)(!0),c=i[0],d=i[1];return(0,s.useEffect)(function(){var e=(0,l.hg)(u,function(e){return v(void 0,void 0,void 0,function(){var t,r,n,s,a,l;return b(this,function(i){switch(i.label){case 0:if(console.log("Auth state changed:",{uid:null==e?void 0:e.uid,email:null==e?void 0:e.email,timestamp:(new Date).toISOString()}),!e)return[3,11];i.label=1;case 1:return i.trys.push([1,9,,10]),e.email&&y(e.email)?(console.log("HQ admin detected:",e.email),o({uid:e.uid,email:e.email,displayName:e.displayName,role:"hq"}),d(!1),[2]):[3,2];case 2:if(!(t=e.email||""))return[3,7];console.log("AuthContext: Store manager detected, email:",t),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,j(t)];case 4:return(r=i.sent())?(console.log("AuthContext: Store manager data found:",r),o({uid:e.uid,email:e.email,displayName:e.displayName,role:r.role||"store",storeName:r.storeName,extraEmail:r.extraEmail,country:r.country||"대한민국",countryCode:r.countryCode||f(r.country||"대한민국"),region:r.region||"경상북도",city:r.city||"포항시",storeId:r.storeId||h(t)})):(console.warn("AuthContext: Store manager document not found for email:",t),s=p(t),a="US"===s?"United States":"대한민국",o({uid:e.uid,email:e.email,displayName:e.displayName,role:null,country:a,countryCode:s,region:"KR"===s?"경상북도":"California",city:"KR"===s?"포항시":"Los Angeles",storeId:h(t)})),[3,6];case 5:return n=i.sent(),console.error("AuthContext: Store manager data query failed:",n),s=p(t),a="US"===s?"United States":"대한민국",o({uid:e.uid,email:e.email,displayName:e.displayName,role:null,country:a,countryCode:s,region:"KR"===s?"경상북도":"California",city:"KR"===s?"포항시":"Los Angeles",storeId:h(t)}),[3,6];case 6:return[3,8];case 7:console.warn("AuthContext: Unknown user type, email:",t),o({uid:e.uid,email:e.email,displayName:e.displayName,role:null}),i.label=8;case 8:return[3,10];case 9:return l=i.sent(),console.error("Auth context error:",l),o({uid:e.uid,email:e.email,displayName:e.displayName,role:null}),[3,10];case 10:return[3,12];case 11:o(null),i.label=12;case 12:return d(!1),[2]}})})});return function(){return e()}},[]),(0,n.jsx)(N.Provider,{value:{user:a,loading:c},children:t})},S=function(){return S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},S.apply(this,arguments)},k=function(e,t,r){if(r||2===arguments.length)for(var n,s=0,a=t.length;s<a;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))},A=(0,s.createContext)(void 0),I=function(e){var t=e.children,r=(0,s.useState)([]),a=r[0],o=r[1],l={notifications:a,addNotification:(0,s.useCallback)(function(e){var t=Date.now().toString(),r=S(S({},e),{id:t});o(function(e){return k(k([],e,!0),[r],!1)})},[]),removeNotification:(0,s.useCallback)(function(e){o(function(t){return t.filter(function(t){return t.id!==e})})},[]),clearNotifications:(0,s.useCallback)(function(){o([])},[])};return(0,n.jsx)(A.Provider,{value:l,children:t})},D=(0,s.createContext)(void 0),E=function(){var e=(0,s.useContext)(D);if(!e)throw new Error("useCountry must be used within a CountryProvider");return e},R=function(e){var t=e.children,r=(0,s.useState)("ALL"),a=r[0],o=r[1];return(0,n.jsx)(D.Provider,{value:{selectedCountry:a,setSelectedCountry:o},children:t})};const T=function(){return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-950 via-slate-900 to-gray-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-gray-800 border-t-violet-500 rounded-full animate-spin"}),(0,n.jsx)("div",{className:"absolute inset-0 w-16 h-16 border-4 border-transparent border-b-cyan-500 rounded-full animate-spin",style:{animationDelay:"150ms"}})]})})};var P=function(e){var t=e.children,r=e.requiredRole,s=w(),a=s.user,l=s.loading,i=(0,o.zy)(),c=(0,o.ok)()[0];if(console.log("ProtectedRoute check:",{loading:l,user:a?{uid:a.uid,email:a.email,role:a.role}:null,requiredRole:r,path:i.pathname}),l)return(0,n.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,n.jsx)(T,{})});if(!a)return console.log("No user found, redirecting to login"),(0,n.jsx)(o.C5,{to:"/login",state:{from:i},replace:!0});if(!r)return console.log("Common page access, no role restriction"),(0,n.jsx)(n.Fragment,{children:t});if(a.role!==r){console.log("Role mismatch:",{userRole:a.role,requiredRole:r});var u=c.get("store");if("store"===r&&"hq"===a.role&&u)return console.log("Specific store mode: HQ admin accessing store system, access granted"),(0,n.jsx)(n.Fragment,{children:t});switch(a.role){case"hq":return console.log("HQ admin accessing store page, redirecting to storemanager"),(0,n.jsx)(o.C5,{to:"/storemanager",replace:!0});case"store":return console.log("Store manager accessing hq page, redirecting to system"),(0,n.jsx)(o.C5,{to:"/system",replace:!0});default:return console.log("Unknown role, showing access denied"),(0,n.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"접근 거부"}),(0,n.jsx)("p",{className:"text-gray-300 mb-2",children:"이 페이지에 접근할 권한이 없습니다."}),(0,n.jsxs)("p",{className:"text-gray-400 text-sm",children:["현재 역할: ",a.role||"없음"," | 필요 역할: ",r]})]})})}}return console.log("Access granted, rendering children"),(0,n.jsx)(n.Fragment,{children:t})},L=function(){var e=w(),t=e.user;if(e.loading)return(0,n.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-white",children:"로딩 중..."})});if(!t)return console.log("No user found, redirecting to login"),(0,n.jsx)(o.C5,{to:"/login",replace:!0});switch(t.role){case"hq":return console.log("HQ admin logged in, redirecting to storemanager"),(0,n.jsx)(o.C5,{to:"/storemanager",replace:!0});case"store":return console.log("Store manager logged in, redirecting to dashboard"),(0,n.jsx)(o.C5,{to:"/dashboard",replace:!0});default:return console.log("Unknown role, redirecting to login"),(0,n.jsx)(o.C5,{to:"/login",replace:!0})}},U=r(2167),O=r(2957),F=r(2574),K=r(9818),M=r(4576),q=r(4180),_=r(5410),H=[{code:"ALL",name:"All Countries",aliases:["all","전체"]},{code:"KR",name:"South Korea",aliases:["korea","south korea","대한민국","한국"]},{code:"KP",name:"North Korea",aliases:["north korea","북한"]},{code:"US",name:"United States",aliases:["usa","america","united states of america","미국"]},{code:"JP",name:"Japan",aliases:["japan","일본"]},{code:"CN",name:"China",aliases:["china","중국"]},{code:"GB",name:"United Kingdom",aliases:["uk","britain","england","영국"]},{code:"DE",name:"Germany",aliases:["deutschland","독일"]},{code:"FR",name:"France",aliases:["france","프랑스"]},{code:"IT",name:"Italy",aliases:["italy","이탈리아"]},{code:"ES",name:"Spain",aliases:["spain","에스파냐"]},{code:"NL",name:"Netherlands",aliases:["holland","nederland","네덜란드"]}];const G=function(e){var t=e.value,r=e.onChange,a=e.placeholder,o=void 0===a?"Search country...":a,l=(0,s.useState)(!1),i=l[0],c=l[1],u=(0,s.useState)(""),d=u[0],m=u[1],x=(0,s.useState)(H),h=x[0],f=x[1],p=(0,s.useState)(null),g=p[0],y=p[1],v=(0,s.useRef)(null);return(0,s.useEffect)(function(){var e=H.find(function(e){return e.code===t});y(e||null),m((null==e?void 0:e.name)||"")},[t]),(0,s.useEffect)(function(){if(d){var e=H.filter(function(e){var t,r=d.toLowerCase(),n=e.name.toLowerCase().includes(r),s=e.code.toLowerCase().includes(r),a=null===(t=e.aliases)||void 0===t?void 0:t.some(function(e){return e.toLowerCase().includes(r)});return n||s||a});f(e)}else f(H)},[d]),(0,s.useEffect)(function(){var e=function(e){v.current&&!v.current.contains(e.target)&&c(!1)};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}},[]),(0,n.jsxs)("div",{className:"relative",ref:v,children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"text",value:d,onChange:function(e){var t=e.target.value;m(t),i||c(!0)},onFocus:function(){c(!0)},placeholder:o,className:"w-full bg-gray-700 text-white px-3 py-2 pr-10 rounded border border-gray-600 focus:border-cyan-500 focus:outline-none text-sm"}),(0,n.jsx)("button",{onClick:function(){c(!i)},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white focus:outline-none",children:(0,n.jsx)(_.A,{className:"w-4 h-4 transition-transform ".concat(i?"rotate-180":"")})})]}),i&&(0,n.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:0===h.length?(0,n.jsx)("div",{className:"px-3 py-2 text-gray-400 text-sm",children:"No countries found"}):h.map(function(e){return(0,n.jsxs)("div",{onClick:function(){return function(e){y(e),m(e.name),r(e.code),c(!1)}(e)},className:"px-3 py-2 cursor-pointer text-sm transition-colors ".concat((null==g?void 0:g.code)===e.code?"bg-cyan-600/20 text-cyan-400":"text-gray-300 hover:bg-gray-700 hover:text-white"),children:[(0,n.jsx)("div",{className:"font-medium",children:e.name}),(0,n.jsx)("div",{className:"text-xs text-gray-400",children:e.code})]},e.code)})})]})};var z=[{name:"매장 관리자",href:"/storemanager",icon:U.A},{name:"대시보드",href:"/dashboard",icon:O.A},{name:"시스템",href:"/system",icon:F.A},{name:"설정",href:"/settings",icon:K.A}],B=function(e){var t=e.isOpen,r=void 0!==t&&t,a=e.onClose,l=(0,o.zy)(),i=w().user,c=E(),u=c.selectedCountry,d=c.setSelectedCountry,m=(0,s.useState)(window.innerWidth>=1024),x=m[0],h=m[1];(0,s.useEffect)(function(){var e=function(){h(window.innerWidth>=1024)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);var f=x||r,p=function(){a&&a()};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mobile-nav ".concat(f?"translate-x-0":"-translate-x-full"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 lg:hidden",children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"스크린골프 관리"}),(0,n.jsx)("button",{onClick:a,className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-gray-800",children:(0,n.jsx)(M.A,{className:"w-6 h-6"})})]}),(0,n.jsx)("div",{className:"hidden lg:flex items-center justify-center h-20 px-4 bg-gradient-to-r from-cyan-600 via-blue-600 to-indigo-600",children:(0,n.jsx)("h1",{className:"text-xl font-bold text-white",children:"스크린골프 관리"})}),"hq"===(null==i?void 0:i.role)&&(0,n.jsx)("div",{className:"px-4 pt-6 pb-4",children:(0,n.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[(0,n.jsx)("label",{className:"text-gray-300 text-xs font-medium mb-2 block",children:"국가 선택"}),(0,n.jsx)(G,{value:u,onChange:function(e){d(e),console.log("Country selected in Sidebar:",e)},placeholder:"Search country..."})]})}),(0,n.jsx)("div",{className:"px-4 pb-2",children:(0,n.jsxs)(o.N_,{to:"/login",onClick:p,className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-300 touch-target ".concat("/"===l.pathname?"bg-cyan-600/20 text-cyan-400 border-r-2 border-cyan-400":"text-gray-400 hover:bg-gray-800/50 hover:text-white"),children:[(0,n.jsx)(q.A,{className:"w-5 h-5 mr-3"}),"홈으로"]})}),(0,n.jsx)("nav",{className:"mt-2",children:(0,n.jsx)("div",{className:"px-4 space-y-2",children:z.map(function(e){var t=e.icon,r=l.pathname===e.href;return"hq"===(null==i?void 0:i.role)&&"시스템"===e.name||"store"===(null==i?void 0:i.role)&&"매장 관리자"===e.name?null:(0,n.jsx)("div",{children:(0,n.jsxs)(o.N_,{to:e.href,onClick:p,className:"flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-300 touch-target ".concat(r?"bg-cyan-600/20 text-cyan-400 border-r-2 border-cyan-400":"text-gray-400 hover:bg-gray-800/50 hover:text-white"),children:[(0,n.jsx)(t,{className:"w-5 h-5 mr-3"}),e.name]})},e.name)})})})]})})},J=r(4278),W=r(8624),Z={"/":{title:"홈",icon:q.A,color:"text-cyan-400",description:"스크린골프 관리 시스템 메인 페이지",details:["시스템 개요","빠른 링크","사용자 가이드"]},"/dashboard":{title:"대시보드",icon:O.A,color:"text-blue-400",description:"시스템 대시보드 및 통계",details:["실시간 통계","성과 지표","데이터 분석"]},"/system":{title:"시스템 관리",icon:F.A,color:"text-purple-400",description:"스토어 및 시스템 관리",details:["스토어 관리","방 상태 제어","시스템 설정"]},"/settings":{title:"설정",icon:K.A,color:"text-gray-400",description:"애플리케이션 설정 및 환경 설정",details:["사용자 설정","시스템 설정","환경 설정"]},"/storemanager":{title:"매장 관리자 관리",icon:U.A,color:"text-emerald-400",description:"매장 관리자 및 권한 관리",details:["관리자 목록","승인 처리","권한 설정"]}},Q=function(e){var t=e.onMenuClick,r=w().user,a=(0,o.zy)(),l=(0,s.useState)(!1),i=l[0],c=l[1],u=(0,s.useState)(navigator.onLine),d=u[0],m=u[1];(0,s.useEffect)(function(){var e=function(){return m(!0)},t=function(){return m(!1)};return window.addEventListener("online",e),window.addEventListener("offline",t),function(){window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);var x,h=(x=a.pathname,Z[x]||Z["/"]),f=h.icon;return s.useEffect(function(){var e=function(e){var t=e.target,r=t.closest("header"),n=t.closest(".dynamic-panel");r&&!n&&c(!1)};if(i)return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[i]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("header",{className:"mobile-header",children:(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:t,className:"mobile-menu-button touch-target",title:"메뉴",children:(0,n.jsx)(J.A,{})}),(0,n.jsxs)("div",{className:"ml-4 flex items-center",children:[(0,n.jsx)(f,{className:"w-8 h-8 mr-3 ".concat(h.color)}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white",children:h.title})]})]}),(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-white",children:(null==r?void 0:r.displayName)||"관리자"}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:(null==r?void 0:r.email)||"admin@screengolf.com"})]}),(0,n.jsx)("div",{className:"w-10 h-10 bg-cyan-600 rounded-full flex items-center justify-center",children:(0,n.jsx)(W.A,{className:"w-6 h-6 text-white"})})]})})]})}),(0,n.jsx)("header",{className:"hidden lg:block bg-gray-900/95 backdrop-blur-xl border-b border-gray-700/50",children:(0,n.jsxs)("div",{className:"flex items-center justify-between px-8 h-20",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(f,{className:"w-10 h-10 mr-4 ".concat(h.color)}),(0,n.jsx)("h2",{className:"text-2xl font-semibold text-white",children:h.title})]}),(0,n.jsx)("div",{className:"flex items-center space-x-6",children:(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-base font-medium text-white",children:(null==r?void 0:r.displayName)||"관리자"}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:(null==r?void 0:r.email)||"admin@screengolf.com"})]}),(0,n.jsx)("div",{className:"w-12 h-12 bg-cyan-600 rounded-full flex items-center justify-center",children:(0,n.jsx)(W.A,{className:"w-8 h-8 text-white"})})]})}),(0,n.jsx)("div",{className:"absolute right-8 top-20 w-80 bg-gray-900/95 backdrop-blur-xl border border-gray-700/50 rounded-xl shadow-2xl z-50 transition-all duration-300 ".concat(i?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-2 pointer-events-none"),children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-300",children:"주요 기능:"}),(0,n.jsx)("ul",{className:"space-y-2",children:h.details.map(function(e,t){return(0,n.jsxs)("li",{className:"flex items-center text-sm text-gray-400",children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e]},t)})})]}),(0,n.jsxs)("div",{className:"pt-4 border-t border-gray-700/50",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,n.jsx)("span",{children:"연결 상태:"}),(0,n.jsx)("span",{className:d?"text-green-500":"text-red-500",children:d?"온라인":"오프라인"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,n.jsxs)("span",{children:["마지막 업데이트: ",(new Date).toLocaleString("ko-KR")]}),(0,n.jsx)("button",{onClick:function(){return c(!1)},className:"text-cyan-400 hover:text-cyan-300 transition-colors",children:"닫기"})]})]})]})})]})})]})},Y=r(7117),V=r(6156),$=r(4015);const X=function(e){var t=e.notification,r=e.onClose;return(0,s.useEffect)(function(){var e=setTimeout(function(){r()},t.duration||5e3);return function(){return clearTimeout(e)}},[t.id,t.duration,r]),(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full animate-pulse",children:(0,n.jsx)("div",{className:"p-4 rounded-lg shadow-lg border ".concat(function(){switch(t.type){case"success":return"bg-emerald-50 border-emerald-200 text-emerald-800";case"warning":return"bg-amber-50 border-amber-200 text-amber-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}}()," backdrop-blur-sm"),children:(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:function(){switch(t.type){case"success":return(0,n.jsx)(Y.A,{className:"w-5 h-5 text-emerald-500"});case"warning":return(0,n.jsx)(V.A,{className:"w-5 h-5 text-amber-500"});case"error":return(0,n.jsx)(V.A,{className:"w-5 h-5 text-red-500"});default:return(0,n.jsx)($.A,{className:"w-5 h-5 text-blue-500"})}}()}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("h4",{className:"text-sm font-semibold mb-1",children:t.title}),(0,n.jsx)("p",{className:"text-sm opacity-90",children:t.message})]}),(0,n.jsx)("button",{onClick:r,className:"flex-shrink-0 p-1 rounded-md hover:bg-black/5 transition-colors",children:(0,n.jsx)(M.A,{className:"w-4 h-4 opacity-60 hover:opacity-100"})})]})})})},ee=function(){var e=function(){var e=(0,s.useContext)(A);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e}(),t=e.notifications,r=e.removeNotification;return(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(function(e){return(0,n.jsx)(X,{notification:e,onClose:function(){return r(e.id)}},e.id)})})};var te=function(e){var t=e.children,r=(0,s.useState)(!1),a=r[0],l=r[1];return(0,n.jsxs)("div",{className:"flex h-screen bg-gradient-to-br from-gray-950 via-slate-900 to-gray-950",children:[a&&(0,n.jsx)("div",{className:"mobile-nav-overlay",onClick:function(){return l(!1)}}),(0,n.jsx)(B,{isOpen:a,onClose:function(){return l(!1)}}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,n.jsx)(Q,{onMenuClick:function(){return l(!a)}}),(0,n.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-950/50 p-4 mobile-content",children:t||(0,n.jsx)(o.sv,{})}),(0,n.jsx)(ee,{})]})]})},re=r(5763),ne=r(2509),se=r(72),ae=r(3211),oe=r(2254),le=r(6304),ie={korean:{subject:"스크린골프 관리 시스템 - 비밀번호 재설정",successMessage:"비밀번호 재설정 링크를 발송했습니다. 이메일을 확인해주세요.",errorMessage:"비밀번호 재설정 이메일 발송에 실패했습니다.",userNotFound:"등록되지 않은 이메일입니다.",invalidEmail:"유효하지 않은 이메일 형식입니다.",tooManyRequests:"너무 많은 요청이 있었습니다. 잠시 후 다시 시도해주세요."},english:{subject:"Screen Golf Management System - Password Reset",successMessage:"Password reset link has been sent. Please check your email.",errorMessage:"Failed to send password reset email.",userNotFound:"User not found.",invalidEmail:"Invalid email format.",tooManyRequests:"Too many requests. Please try again later."}},ce=function(e,t){return function(e,t){var r=function(e,t){var r;if(t)return"대한민국"===t||"한국"===t?"korean":"english";var n=null===(r=e.split("@")[1])||void 0===r?void 0:r.toLowerCase();return["co.kr","kr","ac.kr","go.kr"].some(function(e){return null==n?void 0:n.endsWith(e)})?"korean":"english"}(e,t);return ie[r]}(e,t)},ue=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},de=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},me=function(e,t,r,n,s,a,o){return ue(void 0,void 0,Promise,function(){function c(){return ue(this,void 0,Promise,function(){var c,h,y,v,b,j,N,w,C,S,k;return de(this,function(A){switch(A.label){case 0:if(!(m<x))return[3,8];A.label=1;case 1:return A.trys.push([1,5,,7]),c=function(e,t){if(t){var r=f(t);return g(r)}var n=p(e);return g(n)}(e,o),console.log("Using collection: ".concat(c," for email: ").concat(e,", country: ").concat(o)),h=p(e),y="users_".concat(h),console.log("Checking for duplicate in optimized collection: ".concat(y," for email: ").concat(e)),v=(0,i.H9)(d,y,e),[4,(0,i.x7)(v)];case 2:return A.sent().exists()?(console.log("Found existing user in collection: ".concat(y)),[2,{success:!1,error:"이미 사용 중인 이메일입니다."}]):(j="geolocation",(b=s||"")||(b=o||"대한민국",j="default"),N=b.replace(/^대한민국\s*/,"").trim(),console.log("🔧 국가 정보 제거:",{original:b,cleaned:N}),[4,(0,l.eJ)(u,e,t)]);case 3:return w=A.sent(),C=w.user,S=f(o||"대한민국"),[4,(0,i.BN)((0,i.H9)(d,c,e),{uid:C.uid,email:e,extraEmail:a,storeName:r,phoneNumber:n,role:"store",createdAt:new Date,lastLogin:new Date,approved:!1,clientIP:j,region:N,country:o||"대한민국",countryCode:S,collectionName:c})];case 4:return A.sent(),console.log("User created successfully in collection: ".concat(c)),[2,{success:!0,error:"회원가입이 완료되었습니다. 이메일이 ".concat(e,"(으)로 가입되었습니다. 관리자 승인 후 로그인 가능합니다.")}];case 5:return k=A.sent(),m++,console.error("회원가입 시도 ".concat(m," 실패:"),k),m>=x?[2,{success:!1,error:"auth/email-already-in-use"===(I=k).code?"이미 사용 중인 이메일입니다.":"auth/weak-password"===I.code?"비밀번호가 너무 약합니다. 8자 이상으로 설정해주세요.":"auth/invalid-email"===I.code?"유효하지 않은 이메일 형식입니다.":"permission-denied"===I.code?"권한이 없습니다. 관리자에게 문의하세요.":"resource-exhausted"===I.code?"서버가 일시적으로 과부하입니다. 잠시 후 다시 시도해주세요.":"회원가입 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요."}]:[4,new Promise(function(e){return setTimeout(e,1e3)})];case 6:return A.sent(),[3,7];case 7:return[3,0];case 8:return[2,{success:!1,error:"회원가입 시도 횟수를 초과했습니다. 잠시 후 다시 시도해주세요."}]}var I})})}var m,x,h;return de(this,function(e){switch(e.label){case 0:m=0,x=3,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c()];case 2:return[2,e.sent()];case 3:return h=e.sent(),console.error("회원가입 함수 실행 오류:",h),[2,{success:!1,error:"회원가입 중 심각한 오류가 발생했습니다. 다시 시도해주세요."}];case 4:return[2]}})})},xe=function(){return xe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},xe.apply(this,arguments)},he=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},fe=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}};const pe=function(){var e=(0,o.Zp)(),t=(0,s.useState)(!1),r=t[0],a=t[1],c=(0,s.useState)(""),m=c[0],x=c[1],h=(0,s.useState)(""),f=h[0],g=h[1],v=(0,s.useState)(!1),b=v[0],j=v[1],N=(0,s.useState)(!1),w=N[0],C=N[1],S=(0,s.useState)(!1),k=S[0],A=S[1],I=(0,s.useState)(!1),D=I[0],E=I[1],R=(0,s.useState)(!1),T=R[0],P=R[1],L=(0,s.useState)(""),O=L[0],F=L[1],K=(0,s.useState)(!1),M=K[0],q=K[1],_=(0,s.useState)(""),H=_[0],G=_[1],z=(0,s.useState)({email:"",password:"",confirmPassword:"",storeName:"",phoneNumber:"",location:"",country:"",province:"",city:""}),B=z[0],J=z[1];s.useEffect(function(){var e=localStorage.getItem("rememberedEmail");e&&(J(function(t){return xe(xe({},t),{email:e})}),E(!0))},[]);var Z=function(e){var t=e.target,r=t.name,n=t.value;J(function(e){var t;return xe(xe({},e),((t={})[r]=n,t))})},Q=function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},Y=B.email&&!Q(B.email)?"유효한 이메일 주소를 입력하세요":"";return(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:[(0,n.jsxs)("div",{className:"w-full max-w-md",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-violet-600 to-cyan-600 rounded-2xl shadow-2xl mb-4",children:(0,n.jsx)(U.A,{className:"w-10 h-10 text-white"})}),(0,n.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"스크린 골프 HQ"}),(0,n.jsx)("p",{className:"text-gray-400",children:"본사 및 매장 관리자 포털"})]}),(0,n.jsxs)("div",{className:"bg-gray-900/50 backdrop-blur-xl border border-gray-800 rounded-2xl p-8 shadow-2xl",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:k?"매장 관리자 가입":"로그인"}),(0,n.jsxs)("form",{onSubmit:function(t){return he(void 0,void 0,void 0,function(){var r,n;return fe(this,function(s){switch(s.label){case 0:if(t.preventDefault(),x(""),g(""),!Q(B.email))return x("유효한 이메일 주소를 입력하세요"),[2];if(B.password.length<6)return x("비밀번호는 최소 6자 이상이어야 합니다"),[2];if(k&&B.password!==B.confirmPassword)return x("비밀번호가 일치하지 않습니다"),[2];if(k){if(!B.storeName.trim())return x("매장 이름을 입력하세요"),[2];if(!B.phoneNumber.trim())return x("전화번호를 입력하세요"),[2]}a(!0),s.label=1;case 1:return s.trys.push([1,6,7,8]),k?[4,me(B.email,B.password,B.storeName,B.phoneNumber,B.location,void 0,B.country)]:[3,3];case 2:return(r=s.sent()).success?(g(r.error||"가입이 완료되었습니다. 관리자 승인 후 로그인할 수 있습니다."),setTimeout(function(){A(!1),J({email:B.email,password:"",confirmPassword:"",storeName:"",phoneNumber:"",location:"",country:"",province:"",city:""})},2e3)):x(r.error||"가입 중 오류가 발생했습니다"),[3,5];case 3:return[4,(o=B.email,c=B.password,ue(void 0,void 0,Promise,function(){var e,t,r,n,s,a,m,x,h,f,g;return de(this,function(v){switch(v.label){case 0:return v.trys.push([0,13,,14]),console.log("Attempting email login:",{email:o}),[4,(0,l.x9)(u,o,c)];case 1:if(e=v.sent(),t=e.user,console.log("Firebase auth successful:",{uid:t.uid,email:t.email}),y(o))return console.log("HQ admin detected:",o),[2,{success:!0,user:t,role:"hq"}];console.log("Store manager detected, email:",o),r=p(o),n="users_".concat(r),console.log("Searching in optimized collection: ".concat(n," for email: ").concat(o)),v.label=2;case 2:return v.trys.push([2,10,,12]),s=(0,i.H9)(d,n,o),[4,(0,i.x7)(s)];case 3:return(a=v.sent()).exists()?(m=a,x=n,console.log("Found user in optimized collection: ".concat(x)),h=m.data(),console.log("User data:",{approved:null==h?void 0:h.approved,role:null==h?void 0:h.role}),(null==h?void 0:h.approved)?[3,5]:(console.log("User not approved, signing out"),[4,(0,l.CI)(u)])):[3,7];case 4:return v.sent(),[2,{success:!1,error:"관리자 승인이 필요합니다. 본사 관리자에게 문의하세요."}];case 5:return[4,(0,i.BN)((0,i.H9)(d,x,o),{lastLogin:new Date},{merge:!0})];case 6:return v.sent(),console.log("Last login updated successfully"),[2,{success:!0,user:t,role:"store"}];case 7:return console.log("User not found in optimized collection, signing out"),[4,(0,l.CI)(u)];case 8:return v.sent(),[2,{success:!1,error:"매장 관리자 계정이 아닙니다."}];case 9:return[3,12];case 10:return f=v.sent(),console.log("Error searching collection ".concat(n,":"),f),[4,(0,l.CI)(u)];case 11:return v.sent(),[2,{success:!1,error:"로그인 중 오류가 발생했습니다."}];case 12:return[3,14];case 13:return g=v.sent(),console.error("로그인 에러:",g),"auth/user-not-found"===g.code?[2,{success:!1,error:"등록되지 않은 이메일입니다."}]:"auth/wrong-password"===g.code?[2,{success:!1,error:"비밀번호가 올바르지 않습니다."}]:"auth/invalid-email"===g.code?[2,{success:!1,error:"유효하지 않은 이메일 형식입니다."}]:"auth/too-many-requests"===g.code?[2,{success:!1,error:"너무 많은 로그인 시도가 있었습니다. 잠시 후 다시 시도해주세요."}]:[2,{success:!1,error:"로그인 중 오류가 발생했습니다."}];case 14:return[2]}})}))];case 4:(r=s.sent()).success?(g("로그인 성공!"),D?localStorage.setItem("rememberedEmail",B.email):localStorage.removeItem("rememberedEmail"),setTimeout(function(){e("/redirect")},1e3)):x(r.error||"로그인 중 오류가 발생했습니다"),s.label=5;case 5:return[3,8];case 6:return n=s.sent(),console.error("인증 에러:",n),x("인증 중 오류가 발생했습니다. 다시 시도해주세요"),[3,8];case 7:return a(!1),[7];case 8:return[2]}var o,c})})},className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"이메일 주소"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)(re.A,{className:"h-5 w-5 text-gray-400"})}),(0,n.jsx)("input",{type:"email",name:"email",value:B.email,onChange:Z,required:!0,autoComplete:"username",className:"w-full pl-10 pr-3 py-3 bg-gray-800/50 border rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 transition-all duration-300 backdrop-blur-sm ".concat(Q(B.email)&&B.email?"border-gray-700/50 focus:ring-cyan-500/50 focus:border-cyan-500/50":B.email&&!Q(B.email)?"border-red-500/50 focus:ring-red-500/50 focus:border-red-500/50":"border-gray-700/50 focus:ring-cyan-500/50 focus:border-cyan-500/50"),placeholder:"이메일 주소를 입력하세요"})]}),Y&&(0,n.jsx)("p",{className:"mt-1 text-xs text-red-400",children:Y})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"비밀번호"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)(W.A,{className:"h-5 w-5 text-gray-400"})}),(0,n.jsx)("input",{type:b?"text":"password",name:"password",value:B.password,onChange:Z,required:!0,minLength:6,autoComplete:k?"new-password":"current-password",className:"w-full pl-10 pr-12 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300 backdrop-blur-sm",placeholder:"비밀번호를 입력하세요"}),(0,n.jsx)("button",{type:"button",onClick:function(){return j(!b)},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:b?(0,n.jsx)(ne.A,{className:"h-5 w-5 text-gray-400 hover:text-cyan-400"}):(0,n.jsx)(se.A,{className:"h-5 w-5 text-gray-400 hover:text-cyan-400"})})]})]}),k&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"비밀번호 확인"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)(W.A,{className:"h-5 w-5 text-gray-400"})}),(0,n.jsx)("input",{type:w?"text":"password",name:"confirmPassword",value:B.confirmPassword,onChange:Z,required:!0,minLength:6,autoComplete:"new-password",className:"w-full pl-10 pr-12 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300 backdrop-blur-sm",placeholder:"비밀번호를 다시 입력하세요"}),(0,n.jsx)("button",{type:"button",onClick:function(){return C(!w)},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:w?(0,n.jsx)(ne.A,{className:"h-5 w-5 text-gray-400 hover:text-cyan-400"}):(0,n.jsx)(se.A,{className:"h-5 w-5 text-gray-400 hover:text-cyan-400"})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"매장 이름"}),(0,n.jsx)("input",{type:"text",name:"storeName",value:B.storeName,onChange:Z,required:!0,className:"w-full px-3 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300 backdrop-blur-sm",placeholder:"매장 이름을 입력하세요"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"전화번호"}),(0,n.jsx)("input",{type:"tel",name:"phoneNumber",value:B.phoneNumber,onChange:Z,required:!0,className:"w-full px-3 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300 backdrop-blur-sm",placeholder:"전화번호를 입력하세요"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"위치 정보"}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("input",{type:"text",name:"location",value:B.location,onChange:Z,className:"flex-1 px-3 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300 backdrop-blur-sm",placeholder:"위치 정보",readOnly:!0}),(0,n.jsx)("button",{type:"button",onClick:function(){return he(void 0,void 0,void 0,function(){return fe(this,function(e){return P(!0),F(""),navigator.geolocation?(navigator.geolocation.getCurrentPosition(function(e){return he(void 0,void 0,void 0,function(){var t,r,n,s,a,o,l,i,c;return fe(this,function(u){switch(u.label){case 0:t=e.coords,r=t.latitude,n=t.longitude,u.label=1;case 1:return u.trys.push([1,4,,5]),[4,fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(r,"&lon=").concat(n,"&accept-language=ko&extratags=1&namedetails=1"))];case 2:return[4,u.sent().json()];case 3:return(s=u.sent())&&s.address?(a=s.address,o=a.country||"",l=a.state||a.province||"",i=a.city||a.town||a.village||"",J(function(e){return xe(xe({},e),{country:o,province:l,city:i,location:"".concat(o," ").concat(l," ").concat(i).trim()})})):J(function(e){return xe(xe({},e),{location:"주소를 찾을 수 없습니다"})}),[3,5];case 4:return c=u.sent(),console.error("주소 변환 실패:",c),J(function(e){return xe(xe({},e),{location:"주소 변환 실패"})}),[3,5];case 5:return P(!1),[2]}})})},function(e){switch(P(!1),e.code){case e.PERMISSION_DENIED:F("위치 권한이 필요합니다");break;case e.POSITION_UNAVAILABLE:F("위치 정보를 사용할 수 없습니다");break;case e.TIMEOUT:F("위치 정보 요청 시간이 초과되었습니다");break;default:F("위치 정보를 가져오는데 실패했습니다")}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}),[2]):(F("이 브라우저는 위치 정보를 지원하지 않습니다"),P(!1),[2])})})},disabled:T,className:"px-4 py-3 bg-gray-700/50 text-white rounded-full hover:bg-gray-600/50 transition-all duration-300 disabled:opacity-50",children:T?(0,n.jsx)(ae.A,{className:"w-5 h-5 animate-spin"}):(0,n.jsx)(oe.A,{className:"w-5 h-5"})})]}),O&&(0,n.jsx)("p",{className:"mt-1 text-xs text-red-400",children:O})]})]}),!k&&(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,n.jsx)("input",{type:"checkbox",checked:D,onChange:function(e){return E(e.target.checked)},className:"w-4 h-4 text-cyan-600 bg-gray-800/50 border-gray-600/50 rounded-full focus:ring-cyan-500 focus:ring-2 transition-all duration-300"}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:"기억하기"})]}),(0,n.jsx)("button",{type:"button",onClick:function(){return q(!0)},className:"text-sm text-cyan-400 hover:text-cyan-300 transition-colors duration-300",children:"비밀번호를 잊어버리셨나요?"})]}),(0,n.jsx)("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-cyan-600 via-blue-600 to-indigo-600 text-white font-semibold py-4 px-6 rounded-full hover:from-cyan-700 hover:via-blue-700 hover:to-indigo-700 transition-all duration-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl hover:shadow-2xl transform hover:-translate-y-1",children:(0,n.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,n.jsx)("span",{children:r?k?"가입 중...":"로그인 중...":k?"가입하기":"로그인"}),!r&&(0,n.jsx)(le.A,{className:"w-5 h-5"})]})})]}),(0,n.jsx)("div",{className:"mt-6 text-center",children:(0,n.jsx)("button",{type:"button",onClick:function(){A(!k),x(""),g(""),J({email:"",password:"",confirmPassword:"",storeName:"",phoneNumber:"",location:"",country:"",province:"",city:""})},className:"text-cyan-400 hover:text-cyan-300 transition-colors duration-300 text-sm",children:k?"이미 계정이 있으신가요? 로그인":"계정이 없으신가요? 가입하기"})})]}),m&&(0,n.jsx)("div",{className:"mt-6 p-4 bg-red-600/20 border border-red-500/30 rounded-full text-red-200 text-center backdrop-blur-xl",children:(0,n.jsx)("p",{className:"font-medium",children:m})}),f&&(0,n.jsx)("div",{className:"mt-6 p-4 bg-emerald-600/20 border border-emerald-500/30 rounded-full text-emerald-200 text-center backdrop-blur-xl",children:(0,n.jsx)("p",{className:"font-medium",children:f})})]}),M&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-6 w-full max-w-md border border-gray-700/50 shadow-2xl",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"비밀번호 재설정"}),(0,n.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"가입하신 이메일 주소를 입력하시면 비밀번호 재설정 링크를 발송해 드립니다."}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"이메일 주소"}),(0,n.jsx)("input",{type:"email",value:H,onChange:function(e){return G(e.target.value)},autoComplete:"username",className:"w-full px-3 py-3 bg-gray-800/50 border border-gray-700/50 rounded-full text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500/50 transition-all duration-300",placeholder:"이메일 주소를 입력하세요"})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:function(){q(!1),G(""),x(""),g("")},className:"flex-1 py-3 px-4 bg-gray-700 text-white rounded-full hover:bg-gray-600 transition-colors duration-300",children:"취소"}),(0,n.jsx)("button",{onClick:function(){return he(void 0,void 0,void 0,function(){var e,t;return fe(this,function(r){switch(r.label){case 0:if(!H.trim()||!Q(H))return x("유효한 이메일 주소를 입력하세요"),[2];a(!0),x(""),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,(n=H,ue(void 0,void 0,Promise,function(){var e,t,r,s,a,o,c,m,x,h;return de(this,function(f){switch(f.label){case 0:f.trys.push([0,8,,9]),console.log("Sending password reset email to:",n),e=void 0,t=p(n),r=["users_".concat(t),"users_KR","users_US","users_JP","users_CN","users_GB","users_DE","users_FR","users_IT","users_ES","users_NL"],s=0,a=r,f.label=1;case 1:if(!(s<a.length))return[3,6];o=a[s],f.label=2;case 2:return f.trys.push([2,4,,5]),[4,(0,i.x7)((0,i.H9)(d,o,n))];case 3:return(c=f.sent()).exists()?(m=c.data(),e=null==m?void 0:m.country,console.log("Found user in collection: ".concat(o,", country: ").concat(e)),[3,6]):[3,5];case 4:return f.sent(),[3,5];case 5:return s++,[3,1];case 6:return h=ce(n,e),[4,(0,l.J1)(u,n)];case 7:return f.sent(),[2,{success:!0,error:h.successMessage}];case 8:return x=f.sent(),console.error("비밀번호 재설정 에러:",x),h=ce(n),"auth/user-not-found"===x.code?[2,{success:!1,error:h.userNotFound}]:"auth/invalid-email"===x.code?[2,{success:!1,error:h.invalidEmail}]:"auth/too-many-requests"===x.code?[2,{success:!1,error:h.tooManyRequests}]:[2,{success:!1,error:h.errorMessage}];case 9:return[2]}})}))];case 2:return(e=r.sent()).success?(g(e.error||"비밀번호 재설정 링크가 발송되었습니다."),q(!1),G("")):x(e.error||"비밀번호 재설정 중 오류가 발생했습니다"),[3,5];case 3:return t=r.sent(),console.error("비밀번호 재설정 에러:",t),x("비밀번호 재설정 중 오류가 발생했습니다. 다시 시도해주세요"),[3,5];case 4:return a(!1),[7];case 5:return[2]}var n})})},disabled:r,className:"flex-1 px-4 py-3 bg-gradient-to-r from-cyan-600 to-blue-600 text-white rounded-full hover:from-cyan-700 hover:to-blue-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"발송 중...":"링크 발송"})]})]})]})})]})};var ge=r(8354);const ye=function(){var e=(0,o.Zp)();return(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 flex items-center justify-center p-4",children:[(0,n.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),(0,n.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"}),(0,n.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-10 animate-pulse"})]}),(0,n.jsxs)("div",{className:"relative z-10 text-center max-w-4xl mx-auto",children:[(0,n.jsxs)("div",{className:"mb-12",children:[(0,n.jsxs)("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 animate-fade-in",children:["스크린골프",(0,n.jsx)("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",children:"본사 관리 시스템"})]}),(0,n.jsx)("p",{className:"text-xl md:text-2xl text-gray-300 mb-8 animate-fade-in-delay",children:"전국 스크린골프 매장을 통합 관리하는 최적의 솔루션"})]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 transform hover:scale-105 transition-all duration-300",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"실시간 통계"}),(0,n.jsx)("p",{className:"text-gray-300 text-sm",children:"전국 매장의 운영 데이터를 실시간으로 확인하고 분석하세요"})]}),(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 transform hover:scale-105 transition-all duration-300",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"회원 관리"}),(0,n.jsx)("p",{className:"text-gray-300 text-sm",children:"모든 매장의 회원 정보를 통합하여 효율적으로 관리하세요"})]}),(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 transform hover:scale-105 transition-all duration-300",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"매출 분석"}),(0,n.jsx)("p",{className:"text-gray-300 text-sm",children:"상세한 매출 데이터로 비즈니스 인사이트를 얻으세요"})]})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,n.jsxs)("button",{onClick:function(){return e("/login")},className:"group inline-flex items-center gap-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-4 px-8 rounded-full hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 shadow-lg",children:["관리자 로그인",(0,n.jsx)(ge.A,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"본사 관리자 • 매장 관리자"})]}),(0,n.jsxs)("div",{className:"mt-16 text-gray-400 text-sm",children:[(0,n.jsx)("p",{children:"© 2024 스크린골프 본사 관리 시스템. All rights reserved."}),(0,n.jsx)("p",{className:"mt-2",children:"문의: admin@screengolf-hq.com"})]})]}),(0,n.jsx)("style",{children:"\n        @keyframes fade-in {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes fade-in-delay {\n          0% {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          50% {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          100% {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .animate-fade-in {\n          animation: fade-in 1s ease-out;\n        }\n        \n        .animate-fade-in-delay {\n          animation: fade-in-delay 1.5s ease-out;\n        }\n      "})]})};var ve=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},be=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},je=function(e){var t=e.data,a=(0,s.useState)(null),o=a[0],l=a[1],i=(0,s.useState)(!0),c=i[0],u=i[1];if((0,s.useEffect)(function(){ve(void 0,void 0,void 0,function(){var e,t;return be(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,Promise.all([r.e(176),r.e(96)]).then(r.bind(r,1617))];case 1:return e=n.sent(),l(e),[3,4];case 2:return t=n.sent(),console.error("Failed to load chart module:",t),[3,4];case 3:return u(!1),[7];case 4:return[2]}})})},[]),c||!o)return(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600"})});var d=o.BarChart,m=o.Bar,x=o.CartesianGrid,h=o.XAxis,f=o.YAxis,p=o.Tooltip,g=o.ResponsiveContainer;return(0,n.jsx)("div",{className:"w-full h-full",children:(0,n.jsx)(g,{width:"100%",height:"100%",children:(0,n.jsxs)(d,{data:t,margin:{top:20,right:30,left:20,bottom:20},children:[(0,n.jsx)(x,{strokeDasharray:"3 3",stroke:"#374151"}),(0,n.jsx)(h,{dataKey:"period",stroke:"#9CA3AF",tick:{fill:"#9CA3AF",fontSize:12},angle:-45,textAnchor:"end",height:40}),(0,n.jsx)(f,{stroke:"#9CA3AF",tick:{fill:"#9CA3AF",fontSize:12},tickFormatter:function(e){return"₩".concat((e/1e3).toFixed(0),"K")}}),(0,n.jsx)(p,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px"},labelStyle:{color:"#F3F4F6"},formatter:function(e){return["₩".concat(e.toLocaleString()),"매출"]}}),(0,n.jsx)(m,{dataKey:"revenue",fill:"#06B6D4",radius:[4,4,0,0]})]})})})},Ne=function(e){return ve(void 0,void 0,void 0,function(){var t,r,n,s,a,o,l;return be(this,function(c){switch(c.label){case 0:console.log("🔍 Dashboard: 매장 데이터 조회 시작:",e),t=0,r=["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],c.label=1;case 1:if(!(t<r.length))return[3,6];n=r[t],c.label=2;case 2:return c.trys.push([2,4,,5]),s=(0,i.H9)(d,"users_".concat(n),e),[4,(0,i.x7)(s)];case 3:return(a=c.sent()).exists()?(o=a.data(),console.log("✅ Dashboard: ".concat(n,"에서 매장 데이터 찾음:"),{email:o.email,storeName:o.storeName,countryCode:o.countryCode,country:o.country,role:o.role}),[2,{uid:o.uid,email:o.email,displayName:o.displayName,role:o.role,storeName:o.storeName,countryCode:o.countryCode,country:o.country,region:o.region,city:o.city,extraEmail:o.extraEmail,storeId:o.storeId}]):[3,5];case 4:return l=c.sent(),console.error("❌ Dashboard: ".concat(n," 조회 오류:"),l),[3,5];case 5:return t++,[3,1];case 6:return console.error("❌ Dashboard: 매장 데이터를 찾을 수 없음:",e),[2,null]}})})};const we=function(){var e=w().user,t=E().selectedCountry,r=(0,o.ok)()[0],a=r.get("store"),l=r.get("country"),c=(0,s.useState)("daily"),u=c[0],m=c[1],x=(0,s.useState)(new Date),f=x[0],p=x[1],g=(0,s.useState)([]),y=g[0],v=g[1],b=(0,s.useState)(!0),j=b[0],N=b[1],C=(0,s.useState)(0),S=C[0],k=C[1],A=(0,s.useState)(0),I=A[0],D=A[1],R=(0,s.useState)(null),T=R[0],P=R[1],L=(0,s.useState)("all"),U=L[0],O=L[1],F=(0,s.useState)(null),K=F[0],M=F[1],q=(0,s.useState)([]),_=q[0],H=q[1],G=(0,s.useState)(!0),z=G[0],B=G[1],J=(0,s.useState)(!1),W=J[0],Z=J[1],Q="store"===(null==e?void 0:e.role),Y=Q&&e.email?h(e.email):null,V=a&&l;s.useEffect(function(){var e=new URLSearchParams(window.location.search),t=e.get("mode"),r=e.get("storeId");"store"===t&&r?(O("store"),M(r)):(O("all"),M(null))},[]);var $,X=function(e){return"₩".concat(e.toLocaleString())};return(0,s.useEffect)(function(){e&&ve(void 0,void 0,void 0,function(){var r,n,s,o,l,c,m,x,p,g,y,b,j,w,C,S,A;return be(this,function(I){switch(I.label){case 0:return console.log("🚀 Dashboard: fetchRevenueData 시작"),console.log("👤 사용자 정보:",{email:null==e?void 0:e.email,role:null==e?void 0:e.role,countryCode:null==e?void 0:e.countryCode,storeName:null==e?void 0:e.storeName}),console.log("🎯 viewMode:",U,"selectedStoreId:",K),console.log("🌍 선택된 국가:",t),r=null==e?void 0:e.countryCode,n=null,"hq"===(null==e?void 0:e.role)&&t&&"ALL"!==t&&(console.log("🌍 HQ 사용자 국가 선택 적용:",t),r=t),"store"===U&&K?(console.log("🏪 매장 모드: 특정 매장 데이터 조회 - selectedStoreId:",K),n=K,[3,4]):[3,1];case 1:return V&&a?(console.log("🔍 구버전 특정 매장 모드: 매장 데이터 조회 - targetStore:",a),[4,Ne(a)]):[3,3];case 2:return(l=I.sent())?(P(l),r=l.countryCode,n=l.storeId||h(a),console.log("✅ 구버전 특정 매장 데이터 찾음:",{storeName:l.storeName,countryCode:r,storeId:n}),[3,4]):(console.error("❌ 구버전 특정 매장 데이터를 찾을 수 없음:",a),N(!1),[2]);case 3:console.log("🌍 전체 모드: 모든 매장 데이터 조회"),I.label=4;case 4:return s=r,o=n||Y,console.log("📍 최종 사용 국가 코드:",s,"(선택된 국가:",t,")"),"store"===(null==e?void 0:e.role)&&a&&a!==e.email?(console.warn("⚠️ 접근 권한 없음: 매장 관리자가 다른 매장 통계 접근 시도"),N(!1),[2]):s||!(null==e?void 0:e.email)?[3,7]:(console.log("Dashboard: countryCode 없음, 직접 매장 데이터 조회 시도"),"movare00@gmail.com"!==e.email||"hq"!==e.role?[3,5]:(console.log("🎯 movare00@gmail.com 본사 관리자 특별 처리 - 기본 countryCode 제공"),s="KR",[3,7]));case 5:return[4,Ne(e.email)];case 6:(null==(l=I.sent())?void 0:l.countryCode)&&(s=l.countryCode,console.log("Dashboard: fallback으로 countryCode 찾음:",s)),I.label=7;case 7:if(!s)return console.error("Dashboard: countryCode를 찾을 수 없어 데이터 조회 불가"),N(!1),console.warn("⚠️ countryCode 없음, 데이터를 조회할 수 없습니다."),v([]),k(0),D(0),console.log("🔄 데이터 없음 상태로 설정 완료"),[2];console.log("Dashboard: 매출 데이터 조회 시작 - countryCode:",s,"storeId:",o),N(!0),I.label=8;case 8:return I.trys.push([8,10,11,12]),c={대한민국:"KR",한국:"KR",Korea:"KR","South Korea":"KR","United States":"US",USA:"US",미국:"US",America:"US"}[E=s]||E,m=(0,i.rJ)(d,"settlements_".concat(c)),console.log("📁 조회 컬렉션:","settlements_".concat(c)),x=new Date(f),p=new Date(f),"daily"===u?(x.setHours(0,0,0,0),p.setHours(23,59,59,999)):"monthly"===u?(x.setDate(1),x.setHours(0,0,0,0),p.setMonth(p.getMonth()+1),p.setDate(0),p.setHours(23,59,59,999)):"yearly"===u&&(x.setMonth(0,1),x.setHours(0,0,0,0),p.setMonth(11,31),p.setHours(23,59,59,999)),console.log("🔍 쿼리 조건:",{startDate:x.toISOString(),endDate:p.toISOString(),periodType:u}),g=(0,i.P)(m,(0,i._M)("createdAt",">=",x),(0,i._M)("createdAt","<=",p),(0,i.My)("createdAt","asc")),[4,(0,i.GG)(g)];case 9:return y=I.sent(),b=[],console.log("📊 쿼리 결과:",{totalDocs:y.docs.length,querySize:y.size,hasData:y.docs.length>0}),0===y.docs.length?(console.warn("⚠️ Firestore에 데이터 없음"),v([]),k(0),D(0),console.log("🔄 데이터 없음 상태로 설정 완료"),N(!1),[2]):(y.forEach(function(e){var t,r,n,s=e.data();console.log("📄 문서 데이터:",{id:e.id,totalFee:s.totalFee,storeName:s.storeName,storeId:s.storeId,createdAt:s.createdAt});var a=(null===(t=s.createdAt)||void 0===t?void 0:t.toDate)?s.createdAt.toDate():s.createdAt instanceof Date?s.createdAt:new Date(s.createdAt),o=(null===(r=s.startTime)||void 0===r?void 0:r.toDate)?s.startTime.toDate():(s.startTime,new Date(s.startTime)),l=(null===(n=s.endTime)||void 0===n?void 0:n.toDate)?s.endTime.toDate():(s.endTime,new Date(s.endTime));b.push({totalFee:s.totalFee||0,createdAt:a,startTime:o,endTime:l,storeName:s.storeName||"",roomName:s.roomName||"",storeId:s.storeId})}),j=b,o&&(j=b.filter(function(e){return e.storeId===o}),console.log("🔍 클라이언트 필터링:",{totalSettlements:b.length,filteredSettlements:j.length,effectiveStoreId:o,viewMode:U,selectedStoreId:K,mode:"store"===U?"새 매장 모드":V?"구버전 특정 매장":"매장 관리자"})),w=function(e,t,r){var n=[];if("daily"===t)for(var s=function(t){var s=e.filter(function(e){return e.createdAt.getHours()===t}),a=s.reduce(function(e,t){return e+t.totalFee},0);n.push({period:"".concat(t.toString().padStart(2,"0"),":00"),revenue:a,count:s.length,date:new Date(r.setHours(t,0,0,0))})},a=0;a<24;a++)s(a);else if("monthly"===t)for(var o=new Date(r.getFullYear(),r.getMonth()+1,0).getDate(),l=function(t){var s=e.filter(function(e){return e.createdAt.getDate()===t}),a=s.reduce(function(e,t){return e+t.totalFee},0);n.push({period:"".concat(t,"일"),revenue:a,count:s.length,date:new Date(r.getFullYear(),r.getMonth(),t)})},i=1;i<=o;i++)l(i);else if("yearly"===t)for(var c=function(t){var s=e.filter(function(e){return e.createdAt.getMonth()===t}),a=s.reduce(function(e,t){return e+t.totalFee},0);n.push({period:"".concat(t+1,"월"),revenue:a,count:s.length,date:new Date(r.getFullYear(),t,1)})},u=0;u<12;u++)c(u);return n}(j,u,f),console.log("📈 데이터 집계 결과:",{beforeFiltering:b.length,afterFiltering:j.length,aggregatedCount:w.length,totalRevenue:w.reduce(function(e,t){return e+t.revenue},0),sampleData:w[0]}),0===w.length?(console.warn("⚠️ 집계된 데이터 없음"),v([]),k(0),D(0),console.log("🔄 데이터 없음 상태로 설정 완료")):(v(w),C=w.reduce(function(e,t){return e+t.revenue},0),S=w.reduce(function(e,t){return e+t.count},0),k(C),D(S),console.log("✅ 실제 데이터 적용 완료:",{total:C,count:S,dataCount:w.length})),[3,12]);case 10:return A=I.sent(),console.error("Dashboard: 매출 데이터 조회 실패:",A),console.error("Dashboard: 사용된 countryCode:",s),console.error("Dashboard: 사용자 정보:",{email:null==e?void 0:e.email,countryCode:null==e?void 0:e.countryCode,role:null==e?void 0:e.role}),console.warn("⚠️ 에러 발생, 데이터를 조회할 수 없습니다."),v([]),k(0),D(0),console.log("🔄 에러 상태로 설정 완료"),[3,12];case 11:return N(!1),[7];case 12:return[2]}var E})})},[u,f,null==e?void 0:e.email,U,K,t]),(0,s.useEffect)(function(){"hq"!==(null==e?void 0:e.role)||W?"hq"!==(null==e?void 0:e.role)&&(console.log("🔄 HQ 사용자가 아니거나 사용자 정보 없음, 매장 목록 비움"),H([]),B(!1),Z(!1)):(console.log("🏪 HQ 사용자 확인, 매장 목록 로드 시작"),B(!0),function(e,t,r){return ve(void 0,void 0,Promise,function(){var n,s,a,o,l,c,u,m,x,h,f,p,g,y,v;return be(this,function(b){switch(b.label){case 0:if(console.log("🏪 Dashboard: 매장 목록 조회 시작:",{countryCode:e,user:null==t?void 0:t.email,selectedCountry:r}),!r||"ALL"===r)return[3,4];console.log("🌍 국가 필터링 적용:",r),b.label=1;case 1:return b.trys.push([1,3,,4]),n=(0,i.rJ)(d,"users_".concat(r)),s=(0,i.P)(n,(0,i._M)("role","==","store")),[4,(0,i.GG)(s)];case 2:return a=b.sent(),console.log("📊 ".concat(r," 필터링 결과:"),a.size,"개 문서 찾음"),o=[],a.forEach(function(e){var t=e.data();if(t.storeName){var n=t.storeName.trim();n&&o.push({id:t.email,name:n,email:t.email,countryCode:r})}}),console.log("✅ 국가 필터링 매장 목록 조회 성공:",o.length,"개 매장"),[2,o];case 3:return l=b.sent(),console.error("❌ ".concat(r," 필터링 매장 목록 조회 실패:"),l),[2,[]];case 4:if("hq"!==(null==t?void 0:t.role))return[3,9];console.log("🎯 본사 관리자 감지, 모든 국가 매장 조회 시작"),c=function(e){var t,r,n,s,a;return be(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),console.log("🔍 본사 관리자용 ".concat(e," 국가 코드로 매장 목록 조회 시도...")),t=(0,i.rJ)(d,"users_".concat(e)),r=(0,i.P)(t,(0,i._M)("role","==","store")),[4,(0,i.GG)(r)];case 1:return n=o.sent(),console.log("📊 ".concat(e," 쿼리 결과:"),n.size,"개 문서 찾음"),s=[],n.forEach(function(t){var r=t.data(),n=r.storeName||r.displayName||r.email;r.email&&n&&s.push({id:r.email,name:n,email:r.email,countryCode:e})}),s.length>0?(console.log("✅ 본사 관리자용 ".concat(e,"에서 매장 목록 조회 성공:"),s.length,"개 매장"),[2,{value:s}]):[3,3];case 2:return a=o.sent(),console.error("❌ 본사 관리자용 ".concat(e," 매장 목록 조회 실패:"),a),[2,"continue"];case 3:return[2]}})},u=0,m=["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],b.label=5;case 5:return u<m.length?(y=m[u],[5,c(y)]):[3,8];case 6:if("object"==typeof(x=b.sent()))return[2,x.value];b.label=7;case 7:return u++,[3,5];case 8:return console.warn("⚠️ 본사 관리자용 모든 국가에서 매장을 찾지 못함"),[2,[]];case 9:h=e||function(e){var t;if(!e)return"";for(var r=null===(t=e.split("@")[1])||void 0===t?void 0:t.toLowerCase(),n=0,s=Object.entries({".kr":"KR",".co.kr":"KR","naver.com":"KR","daum.net":"KR","gmail.com":"US","yahoo.com":"US","outlook.com":"US"});n<s.length;n++){var a=s[n],o=a[0],l=a[1];if(null==r?void 0:r.includes(o))return l}return""}((null==t?void 0:t.email)||""),console.log("🔍 추론된 국가코드:",h),f=function(e){var t,r,n,s,a;return be(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),console.log("🔍 ".concat(e," 국가 코드로 매장 목록 조회 시도...")),t=(0,i.rJ)(d,"users_".concat(e)),r=(0,i.P)(t,(0,i._M)("role","==","store")),[4,(0,i.GG)(r)];case 1:return n=o.sent(),console.log("📊 ".concat(e," 쿼리 결과:"),n.size,"개 문서 찾음"),s=[],n.forEach(function(t){var r=t.data(),n=r.storeName||r.displayName||r.email;r.email&&n&&s.push({id:r.email,name:n,email:r.email,countryCode:e})}),s.length>0?(console.log("✅ ".concat(e,"에서 매장 목록 조회 성공:"),s.length,"개 매장"),console.log("🏪 최종 매장 목록:",s),[2,{value:s}]):[3,3];case 2:return a=o.sent(),console.error("❌ ".concat(e," 매장 목록 조회 실패:"),a),[2,"continue"];case 3:return[2]}})},p=0,g=h?[h]:["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],b.label=10;case 10:return p<g.length?(y=g[p],[5,f(y)]):[3,13];case 11:if("object"==typeof(v=b.sent()))return[2,v.value];b.label=12;case 12:return p++,[3,10];case 13:return console.warn("⚠️ 모든 국가 코드에서 매장을 찾지 못함, 폴백 매장 목록 사용"),[2,[]]}})})}((null==e?void 0:e.countryCode)||"",e,t).then(function(e){H(e),B(!1),console.log("🏪 Dashboard: 실제 매장 목록 로드 완료:",e.length),0===e.length?console.warn("⚠️ 실제 매장 데이터 없음"):console.log("✅ 실제 매장 데이터 로드 성공:",e.length,"개 매장")}).catch(function(e){console.error("❌ 매장 목록 로드 중 에러 발생:",e),H([]),B(!1),Z(!0),console.log("🔄 에러 발생으로 빈 매장 목록 설정")}))},[null==e?void 0:e.role,W,null==e?void 0:e.countryCode,t]),(0,s.useEffect)(function(){if("store"===(null==e?void 0:e.role)&&e.email&&!K){var t=h(e.email);M(t),O("store"),console.log("🏪 매장 관리자 자기 매장 자동 선택:",{email:e.email,storeId:t})}},[null==e?void 0:e.role,e.email,K]),W&&"hq"===(null==e?void 0:e.role)?(0,n.jsx)("div",{className:"space-y-8",children:(0,n.jsx)("div",{className:"card-primary",children:(0,n.jsx)("div",{className:"text-center py-12",children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-900/20 rounded-full flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"매장 목록을 불러올 수 없습니다"}),(0,n.jsx)("p",{className:"text-gray-400 mb-6",children:"매장 데이터를 불러오는 중 오류가 발생했습니다."}),(0,n.jsx)("div",{className:"space-x-2",children:(0,n.jsx)("button",{onClick:function(){Z(!1),window.location.reload()},className:"px-4 py-2 bg-primary text-white rounded-full text-sm hover:bg-primary/90 transition-colors",children:"다시 시도"})})]})})})}):j?(0,n.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600"}),(0,n.jsx)("p",{className:"ml-4 text-gray-400",children:"매출 데이터를 불러오는 중..."})]}):(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{className:"card-primary",children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("h1",{className:"text-h1",children:V&&T?"".concat(T.storeName," 통계"):Q?"내 매장 통계":"매출 통계"})}),(0,n.jsxs)("div",{className:"flex items-center justify-between w-full mb-6",children:["hq"===(null==e?void 0:e.role)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:function(){O("all"),M(null)},className:"px-4 py-3 rounded-full text-sm font-medium transition-colors ".concat("all"===U?"bg-primary text-white":"text-gray-300 hover:text-white"),style:{width:"80px",height:"44px"},children:"전체"}),(0,n.jsx)("button",{onClick:function(){return O("store")},className:"px-4 py-3 rounded-full text-sm font-medium transition-colors ".concat("store"===U?"bg-primary text-white":"text-gray-300 hover:text-white"),style:{width:"80px",height:"44px"},children:"매장"})]}),(0,n.jsx)("div",{className:"flex-grow"}),(0,n.jsx)("button",{onClick:function(){return m("daily")},className:"px-4 py-3 rounded-full text-sm font-medium transition-colors touch-target ".concat("daily"===u?"bg-primary text-white":"text-gray-300 hover:text-white"),style:{width:"80px",height:"44px"},children:"일별"}),(0,n.jsx)("button",{onClick:function(){return m("monthly")},className:"px-4 py-3 rounded-full text-sm font-medium transition-colors touch-target ".concat("monthly"===u?"bg-primary text-white":"text-gray-300 hover:text-white"),style:{width:"80px",height:"44px"},children:"월별"}),(0,n.jsx)("button",{onClick:function(){return m("yearly")},className:"px-4 py-3 rounded-full text-sm font-medium transition-colors touch-target ".concat("yearly"===u?"bg-primary text-white":"text-gray-300 hover:text-white"),style:{width:"80px",height:"44px"},children:"년별"}),(0,n.jsx)("input",{type:"date",value:($=f,$.toISOString().split("T")[0]),onChange:function(e){p(new Date(e.target.value))},className:"px-4 py-3 rounded-full text-sm touch-target border border-gray-600 bg-gray-800 text-white",style:{width:"180px",height:"44px"}})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"card-secondary",children:[(0,n.jsx)("p",{className:"text-caption",children:"총 매출"}),(0,n.jsx)("p",{className:"text-xl lg:text-2xl font-bold text-primary mt-1 mobile-text-sm",children:X(S)})]}),(0,n.jsxs)("div",{className:"card-secondary",children:[(0,n.jsx)("p",{className:"text-caption",children:"총 거래"}),(0,n.jsxs)("p",{className:"text-xl lg:text-2xl font-bold text-secondary mt-1 mobile-text-sm",children:[I.toLocaleString(),"건"]})]})]}),"hq"===(null==e?void 0:e.role)&&"store"===U&&(0,n.jsx)("div",{className:"card-primary",children:(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"매장 선택"}),z?(0,n.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-600 mr-2"}),(0,n.jsx)("p",{className:"text-gray-400",children:"매장 목록을 불러오는 중..."})]}):0===_.length?(0,n.jsxs)("div",{className:"text-center py-4",children:[(0,n.jsx)("p",{className:"text-gray-400 mb-2",children:"매장 목록을 불러올 수 없습니다."}),(0,n.jsxs)("p",{className:"text-caption text-gray-500 mb-3",children:["사용자: ",null==e?void 0:e.email," | 국가: ",null==e?void 0:e.countryCode]}),(0,n.jsx)("button",{onClick:function(){return window.location.reload()},className:"px-4 py-2 bg-primary text-white rounded-full text-sm hover:bg-primary/90 transition-colors",children:"다시 시도"})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("select",{value:K||"",onChange:function(e){return M(e.target.value||null)},className:"mobile-form-input",children:["all"===U&&(0,n.jsx)("option",{value:"",children:"전체 매장"}),_.map(function(e){return(0,n.jsx)("option",{value:e.id,children:e.name},e.id)})]})})]})}),(0,n.jsxs)("div",{className:"card-primary",children:[(0,n.jsx)("h2",{className:"text-h2 mb-6",children:"매출 추이"}),(0,n.jsx)("div",{className:"mobile-chart overflow-hidden",style:{width:"100%",height:"450px"},children:0===y.length?(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-body text-gray-400",children:"store"===U&&K?"해당 매장의 매출 데이터가 없습니다.":"해당 기간의 매출 데이터가 없습니다."})}):(0,n.jsx)(je,{data:y})})]}),(0,n.jsxs)("div",{className:"card-primary",children:[(0,n.jsx)("h2",{className:"text-h2 mb-6",children:"매출 상세"}),0===y.length?(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-body text-gray-400",children:"store"===U&&K?"해당 매장의 매출 데이터가 없습니다.":"해당 기간의 매출 데이터가 없습니다."})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b border-gray-700/50",children:[(0,n.jsx)("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"기간"}),(0,n.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"매출"}),(0,n.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"거래수"}),(0,n.jsx)("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"객단가"})]})}),(0,n.jsx)("tbody",{children:y.filter(function(e){return e.revenue>0}).sort(function(e,t){return t.date.getTime()-e.date.getTime()}).map(function(e,t){return(0,n.jsxs)("tr",{className:"border-b border-gray-700/30 hover:bg-gray-700/20 transition-colors",children:[(0,n.jsx)("td",{className:"py-3 px-4 text-white",children:e.period}),(0,n.jsx)("td",{className:"py-3 px-4 text-right text-primary font-medium",children:X(e.revenue)}),(0,n.jsxs)("td",{className:"py-3 px-4 text-right text-secondary",children:[e.count,"건"]}),(0,n.jsx)("td",{className:"py-3 px-4 text-right text-warning",children:e.count>0?X(Math.round(e.revenue/e.count)):"-"})]},t)})})]})}),(0,n.jsx)("div",{className:"lg:hidden space-y-3",children:y.filter(function(e){return e.revenue>0}).sort(function(e,t){return t.date.getTime()-e.date.getTime()}).map(function(e,t){return(0,n.jsxs)("div",{className:"mobile-card",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,n.jsx)("h3",{className:"text-base font-semibold text-white",children:e.period}),(0,n.jsx)("span",{className:"text-lg font-bold text-primary",children:X(e.revenue)})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:"거래수"}),(0,n.jsxs)("p",{className:"text-white font-medium",children:[e.count,"건"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:"객단가"}),(0,n.jsx)("p",{className:"text-warning font-medium",children:e.count>0?X(Math.round(e.revenue/e.count)):"-"})]})]})]},t)})}),0===y.filter(function(e){return e.revenue>0}).length&&(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("p",{className:"text-body",children:"store"===U&&K?"해당 매장의 매출 데이터가 없습니다.":"해당 기간의 매출 데이터가 없습니다."}),"store"===U&&K&&(0,n.jsxs)("p",{className:"text-caption text-gray-500 mt-2",children:["매장 ID: ",K]})]})]})]})]})};var Ce=r(4998),Se=r(3012),ke=r(5795),Ae=r(1507),Ie=function(e,t){if(!e)return"-";if(e.startsWith("["))return e;var r=function(e){for(var t=x(e),r=0,n=Object.entries(m);r<n.length;r++){var s=n[r],a=s[0],o=s[1];if(x(a)===t)return o}return"+82"}(t||"");return"[".concat(r,"] ").concat(e)},De=function(){return De=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},De.apply(this,arguments)},Ee=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},Re=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}};const Te=function(){var e=w().user,t=E().selectedCountry,r=((0,o.Zp)(),(0,s.useState)([])),a=r[0],l=r[1],c=(0,s.useState)([]),u=c[0],m=c[1],x=(0,s.useState)(!0),f=x[0],p=x[1],g=(0,s.useState)(""),y=g[0],v=g[1],b=(0,s.useState)("ko"),j=b[0],N=b[1],C=(0,s.useState)(!1),S=C[0],k=C[1],A=(0,s.useRef)(null),I="hq"===(null==e?void 0:e.role);(0,s.useEffect)(function(){R()},[]),(0,s.useEffect)(function(){m("ALL"===t?a:a.filter(function(e){return e.countryCode===t}))},[t,a]),(0,s.useEffect)(function(){"KR"===t?N("ko"):["US","GB","AU","CA","NZ"].includes(t)?N("en"):N("ko")},[t]),(0,s.useEffect)(function(){var e=new ResizeObserver(function(e){var t=e[0],r=t.target.querySelector("table");if(r){var n=r.scrollWidth>t.target.clientWidth;k(n)}});return A.current&&!f&&u.length>0&&e.observe(A.current),function(){e.disconnect()}},[u,f]);var D={ko:{countrySelection:"국가 선택",managerList:"매장 목록",system:"시스템",country:"국가",region:"지역",storeName:"매장명",manager:"관리자",phone:"전화번호",createdAt:"가입일",status:"상태",approval:"승인",delete:"삭제",online:"온라인",offline:"오프라인",loading:"매장 목록을 불러오는 중...",error:"매장 목록을 불러오는데 실패했습니다.",managerCount:"개의 매장"},en:{countrySelection:"Country Selection",managerList:"Store List",system:"System",country:"Country",region:"Region",storeName:"Store Name",manager:"Manager",phone:"Phone",createdAt:"Joined",status:"Status",approval:"Approval",delete:"Delete",online:"Online",offline:"Offline",loading:"Loading store list...",error:"Failed to load store list.",managerCount:"stores"}}[j],R=function(){return Ee(void 0,void 0,void 0,function(){var e,t,r,n;return Re(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),p(!0),e=[],t=["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],console.log(" 매장 관리자 데이터 병렬 조회 시작..."),r=t.map(function(e){return Ee(void 0,void 0,void 0,function(){var t,r,n,s;return Re(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=(0,i.rJ)(d,"users_".concat(e)),[4,(0,i.GG)(t)];case 1:return r=a.sent(),n=[],r.forEach(function(t){var r=t.data();"store"===r.role&&n.push({uid:r.uid,email:r.email,extraEmail:r.extraEmail,storeName:r.storeName,phoneNumber:r.phoneNumber,role:r.role,createdAt:r.createdAt,lastLogin:r.lastLogin,approved:r.approved,country:r.country||"알 수 없음",countryCode:e,region:r.region||"알 수 없음",city:r.city||"알 수 없음",clientIP:r.clientIP})}),console.log(" ".concat(e,": ").concat(n.length,"개 매장 관리자 조회 완료")),[2,n];case 2:return s=a.sent(),console.error(" ".concat(e," 조회 오류:"),s),[2,[]];case 3:return[2]}})})}),[4,Promise.all(r)];case 1:return s.sent().forEach(function(t){e.push.apply(e,t)}),console.log(" 전체 매장 관리자 조회 완료: ".concat(e.length,"개")),l(e),[3,4];case 2:return n=s.sent(),console.error("매장 관리자 목록 조회 오류:",n),v("매장 목록을 불러오는데 실패했습니다."),[3,4];case 3:return p(!1),[7];case 4:return[2]}})})},T=function(e,t){return Ee(void 0,void 0,void 0,function(){var r,n;return Re(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),(r=a.find(function(t){return t.uid===e}))?[4,(0,i.mZ)((0,i.H9)(d,"users",r.email),{approved:t,lastLogin:new Date})]:[2];case 1:return s.sent(),l(a.map(function(r){return r.uid===e?De(De({},r),{approved:t}):r})),[3,3];case 2:return n=s.sent(),console.error("승인 상태 변경 오류:",n),v("승인 상태 변경에 실패했습니다."),[3,3];case 3:return[2]}})})},P=function(e){return Ee(void 0,void 0,void 0,function(){var t,r;return Re(this,function(n){switch(n.label){case 0:if(!confirm("정말로 이 매장 관리자를 삭제하시겠습니까?"))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),(t=a.find(function(t){return t.uid===e}))?[4,(0,i.kd)((0,i.H9)(d,"users",t.email))]:[2];case 2:return n.sent(),l(a.filter(function(t){return t.uid!==e})),[3,4];case 3:return r=n.sent(),console.error("매장 관리자 삭제 오류:",r),v("매장 관리자 삭제에 실패했습니다."),[3,4];case 4:return[2]}})})},L=function(e){return e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("ko-KR"):"-"},U=function(e){if(!e)return!1;var t=e.toDate?e.toDate():new Date(e);return((new Date).getTime()-t.getTime())/6e4<=5};return f?(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-400",children:D.loading})]})}):(0,n.jsxs)("div",{className:"space-y-3",children:[y&&(0,n.jsx)("div",{className:"p-4 bg-red-900/50 border border-red-500/50 rounded-lg text-red-200 backdrop-blur-sm",children:y}),(0,n.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-xl shadow-2xl rounded-2xl overflow-hidden border border-gray-700/50",children:[(0,n.jsx)("div",{className:"px-4 py-3 border-b border-gray-700/50",children:(0,n.jsx)("h2",{className:"text-xl font-semibold text-white",children:D.managerList})}),(0,n.jsx)("div",{ref:A,className:"responsive-container transition-all duration-300 ease-in-out",children:S?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("div",{className:"mobile-card-grid",children:u.map(function(e){return(0,n.jsxs)("div",{className:"mobile-card",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-gray-700",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.storeName}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:U(e.lastLogin)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ce.A,{className:"w-4 h-4 text-green-500"}),(0,n.jsx)("span",{className:"text-xs text-green-500",children:D.online})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Se.A,{className:"w-4 h-4 text-red-500"}),(0,n.jsx)("span",{className:"text-xs text-red-500",children:D.offline})]})})]}),(0,n.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[D.manager,":"]}),(0,n.jsx)("span",{className:"text-sm text-white font-medium",children:e.email})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[D.phone,":"]}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:Ie(e.phoneNumber,e.country)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[D.country,":"]}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:e.country||"-"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[D.region,":"]}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:e.region})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[D.createdAt,":"]}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:L(e.createdAt)})]})]}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-gray-700 justify-center",children:[(0,n.jsxs)(o.N_,{to:"/dashboard?mode=store&storeId=".concat(h(e.email)),className:"flex items-center space-x-1 px-4 py-3 bg-green-600/20 text-green-400 rounded-full hover:bg-green-600/30 transition-colors text-sm",children:[(0,n.jsx)(O.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"대시보드"})]}),(0,n.jsxs)(o.N_,{to:"/system?store=".concat(e.email),className:"flex items-center space-x-1 px-4 py-3 bg-cyan-600/20 text-cyan-400 rounded-full hover:bg-cyan-600/30 transition-colors text-sm",children:[(0,n.jsx)(F.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:D.system})]}),I&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:function(){return T(e.uid,!e.approved)},className:"flex items-center space-x-1 px-4 py-3 rounded-full transition-colors text-sm ".concat(e.approved?"bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30":"bg-yellow-600/20 text-yellow-400 hover:bg-yellow-600/30"),children:e.approved?"ko"===j?"승인됨":"Approved":"ko"===j?"대기":"Pending"}),(0,n.jsxs)("button",{onClick:function(){return P(e.uid)},className:"flex items-center space-x-1 px-4 py-3 bg-red-600/20 text-red-400 rounded-full hover:bg-red-600/30 transition-colors text-sm",title:D.delete,children:[(0,n.jsx)(ke.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:D.delete})]})]})]})]},e.uid)})})}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-800/50",children:[(0,n.jsx)("thead",{className:"bg-gray-800/50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:"대시보드"}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.system}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.country}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.region}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.storeName}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.manager}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.phone}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.createdAt}),(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.status}),I&&(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.approval}),I&&(0,n.jsx)("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:D.delete})]})}),(0,n.jsx)("tbody",{className:"bg-gray-900/30 divide-y divide-gray-800/50",children:u.map(function(e){return(0,n.jsxs)("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)(o.N_,{to:"/dashboard?mode=store&storeId=".concat(h(e.email)),className:"inline-block p-2 hover:bg-gray-700/50 rounded-lg transition-colors",title:"매장 통계",children:(0,n.jsx)(O.A,{className:"w-6 h-6 text-green-400"})})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)(o.N_,{to:"/system?store=".concat(e.email),className:"inline-block p-2 hover:bg-gray-700/50 rounded-lg transition-colors",title:"시스템 관리",children:(0,n.jsx)(F.A,{className:"w-6 h-6 text-cyan-400"})})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base text-gray-300",children:e.country||"-"})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base text-gray-300",children:e.region})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base text-gray-300",children:e.storeName})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base font-medium text-white",children:e.email})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base text-gray-300",children:Ie(e.phoneNumber,e.country)})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"text-base text-gray-300",children:L(e.createdAt)})}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,n.jsx)("div",{className:"flex items-center justify-center space-x-2",children:U(e.lastLogin)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ce.A,{className:"w-4 h-4 text-green-500"}),(0,n.jsx)("span",{className:"text-sm text-green-500",children:D.online})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Se.A,{className:"w-4 h-4 text-red-500"}),(0,n.jsx)("span",{className:"text-sm text-red-500",children:D.offline})]})})}),I&&(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:(0,n.jsx)("button",{onClick:function(){return T(e.uid,!e.approved)},className:"px-3 py-1 rounded-lg text-sm font-medium transition-colors ".concat(e.approved?"bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30":"bg-yellow-600/20 text-yellow-400 hover:bg-yellow-600/30"),children:e.approved?"ko"===j?"승인됨":"Approved":"ko"===j?"대기":"Pending"})}),I&&(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:(0,n.jsx)("button",{onClick:function(){return P(e.uid)},className:"p-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors",title:D.delete,children:(0,n.jsx)(ke.A,{className:"w-4 h-4"})})})]},e.uid)})})]})})}),0===u.length&&(0,n.jsxs)("div",{className:"text-center py-6",children:[(0,n.jsx)(Ae.A,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-gray-400",children:"ko"===j?"가입된 매장이 없습니다.":"No registered stores found."})]})]})]})};var Pe=function(){return Pe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Pe.apply(this,arguments)},Le=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},Ue=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},Oe=function(e){return e?e&&"function"==typeof e.toDate?e.toDate():"string"==typeof e?new Date(e):e instanceof Date?e:"number"==typeof e?new Date(e):new Date:new Date};const Fe=function(){var e,t=w().user,r=(0,o.Zp)(),a=(0,o.ok)()[0].get("store");console.log("🟢 SystemManager 컴포넌트 렌더링 즉시 시작",{user:t?{email:t.email,role:t.role,storeName:t.storeName}:"null",targetStoreEmail:a,timestamp:(new Date).toISOString()});var l=(0,s.useState)(!0),c=l[0],u=l[1],m=(0,s.useState)(null),x=m[0],p=m[1],g=(0,s.useState)([]),y=g[0],v=g[1],b=(0,s.useState)({isOpen:!1,room:null,startTime:"",endTime:"",usageTime:"",totalFee:0}),j=b[0],N=b[1],C=(0,s.useState)(null),S=C[0],k=C[1];(0,s.useEffect)(function(){console.log("� SystemManager useEffect 실행 시작",{user:t?{email:t.email,role:t.role,storeName:t.storeName}:"null",targetStoreEmail:a,timestamp:(new Date).toISOString()}),console.log("�🔍 SystemManager: useEffect 시작",{targetStoreEmail:a,user:t,componentMounted:!0}),Le(void 0,void 0,void 0,function(){var e;return Ue(this,function(r){switch(r.label){case 0:return console.log("🔍 SystemManager: loadTargetUser 시작",{targetStoreEmail:a,user:t?{email:t.email,role:t.role,storeName:t.storeName}:null}),a?(console.log("🎯 URL 파라미터 매장 데이터 로드:",a),[4,(n=a,Le(void 0,void 0,void 0,function(){var e,t,r,s,a,o,l,c;return Ue(this,function(u){switch(u.label){case 0:console.log("🔍 매장 데이터 조회 시작:",n),e=0,t=["KR","US","JP","CN","GB","DE","FR","IT","ES","NL"],u.label=1;case 1:if(!(e<t.length))return[3,6];r=t[e],u.label=2;case 2:return u.trys.push([2,4,,5]),s=(0,i.H9)(d,"users_".concat(r),n),[4,(0,i.x7)(s)];case 3:return(a=u.sent()).exists()?(o=a.data(),console.log("✅ ".concat(r,"에서 매장 데이터 찾음:"),{email:o.email,storeName:o.storeName,countryCode:o.countryCode,country:o.country,roomsCount:(null===(c=o.rooms)||void 0===c?void 0:c.length)||0}),[2,{uid:o.uid,email:o.email,displayName:o.displayName,role:o.role,storeName:o.storeName,countryCode:o.countryCode,country:o.country,region:o.region,city:o.city,extraEmail:o.extraEmail}]):[3,5];case 4:return l=u.sent(),console.error("❌ ".concat(r," 조회 오류:"),l),[3,5];case 5:return e++,[3,1];case 6:return console.error("❌ 매장 데이터를 찾을 수 없음:",n),[2,null]}})}))]):[3,2];case 1:return e=r.sent(),console.log("🔄 targetUser 설정 (URL 파라미터):",e),k(e),[3,3];case 2:console.log("👤 현재 사용자 데이터 사용"),console.log("🔄 targetUser 설정 (현재 사용자):",t),k(t),r.label=3;case 3:return console.log("✅ loadTargetUser 완료"),[2]}var n})})},[a,t]);var A=(0,s.useState)({ratePerInterval:5e3,timeInterval:10,roomCount:4}),I=A[0],D=A[1];(0,s.useEffect)(function(){console.log("🔄 initializeSystemData useEffect 시작",{targetUser:S?{email:S.email,role:S.role,countryCode:S.countryCode}:"null",timestamp:(new Date).toISOString()}),S?Le(void 0,void 0,void 0,function(){var e,t,r,n,s,a,o,l,c;return Ue(this,function(m){switch(m.label){case 0:if(!(null==S?void 0:S.email)||!(null==S?void 0:S.countryCode))return console.error("타겟 사용자 정보가 없습니다."),u(!1),[2];m.label=1;case 1:return m.trys.push([1,5,6,7]),console.log("🚀 시스템 데이터 초기화 시작...",{email:S.email,countryCode:S.countryCode,storeName:S.storeName}),e=(0,i.H9)(d,"users_".concat(S.countryCode),S.email),[4,(0,i.x7)(e)];case 2:return(t=m.sent()).exists()?(r=t.data(),console.log("📋 사용자 데이터 로드 완료:",{roomsCount:(null===(c=r.rooms)||void 0===c?void 0:c.length)||0,roomCount:r.roomCount,ratePerInterval:r.ratePerInterval}),n=r.ratePerInterval||Math.round(10*(r.ratePer10Minutes||5e3)/(r.timeInterval||10)),D({ratePerInterval:n,timeInterval:r.timeInterval||10,roomCount:r.roomCount||4}),s=r.rooms||[],console.log("🏠 방 데이터 설정:",s.length,"개"),v(s),a=r.roomCount||4,(o=s.length)===a?[3,4]:(console.log("🎯 방 갯수 조절 필요: ".concat(o," → ").concat(a)),[4,E(a)])):(console.error("사용자 문서가 존재하지 않습니다."),u(!1),[2]);case 3:m.sent(),m.label=4;case 4:return console.log("✅ 시스템 데이터 초기화 완료"),[3,7];case 5:return l=m.sent(),console.error("❌ 시스템 데이터 초기화 오류:",l),p("시스템 데이터를 불러오는데 실패했습니다."),[3,7];case 6:return u(!1),[7];case 7:return[2]}})}):console.log("⏸️ targetUser가 없어 초기화 스킵")},[S]),(0,s.useEffect)(function(){if((null==S?void 0:S.email)&&(null==S?void 0:S.countryCode)&&!c){console.log("🔄 실시간 데이터 감지 시작...");var e=(0,i.H9)(d,"users_".concat(S.countryCode),S.email),t=(0,i.aQ)(e,function(e){var t;if(e.exists()){var r=e.data();console.log("📡 실시간 데이터 업데이트:",{roomsCount:(null===(t=r.rooms)||void 0===t?void 0:t.length)||0,roomCount:r.roomCount,ratePerInterval:r.ratePerInterval});var n=r.rooms||[];v(n)}},function(e){console.error("🔥 실시간 데이터 감지 오류:",e)});return function(){console.log("🛑 실시간 데이터 감지 정리"),t()}}},[S,c]);var E=function(e){return Le(void 0,void 0,Promise,function(){var t,r,n,s,a,o,l,c,u,m,x,h,f;return Ue(this,function(p){switch(p.label){case 0:return(null==S?void 0:S.email)&&(null==S?void 0:S.countryCode)?(t=(0,i.H9)(d,"users_".concat(S.countryCode),S.email),[4,(0,i.x7)(t)]):(console.error("사용자 정보가 없습니다."),[2,[]]);case 1:if(!(r=p.sent()).exists())return console.error("사용자 문서가 존재하지 않습니다."),[2,[]];if(n=r.data(),s=n.rooms||[],a=s.length,l=n.ratePer10Minutes||5e3,c=n.timeInterval||10,o=Math.round(l/c*60),u=function(e,t,r){if(r||2===arguments.length)for(var n,s=0,a=t.length;s<a;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}([],s,!0),a<e)for(m=e-a,console.log("".concat(m,"개의 방 생성 (기본 요금: ").concat(o,"원/시간)")),x=a;x<e;x++)h={id:"room-".concat(x+1),name:"방 ".concat(x+1),roomNumber:x+1,status:"available",hourlyRate:o,createdAt:new Date},u.push(h);else a>e?(f=a-e,console.log("".concat(f,"개의 방 삭제 (마지막 방부터)")),u=u.slice(0,e)):u=s.map(function(e){return Pe(Pe({},e),{hourlyRate:o})});return[4,(0,i.mZ)(t,{rooms:u,updatedAt:new Date})];case 2:return p.sent(),console.log("방 갯수 조절 완료:",u.length),[2,u]}})})},R=(0,s.useState)(new Date),T=R[0],P=R[1];(0,s.useEffect)(function(){var e=setInterval(function(){P(new Date)},1e3);return function(){return clearInterval(e)}},[]);var L=(0,s.useCallback)(function(e){if(!e.gameStartTime)return"0분";var t=Oe(e.gameStartTime),r=T.getTime()-t.getTime();r<0&&(r=0);var n=Math.floor(r/6e4),s=Math.floor(n/60),a=n%60,o=Math.floor(r%6e4/1e3);return s>0?"".concat(s,"시간 ").concat(a,"분 ").concat(o,"초"):a>0?"".concat(a,"분 ").concat(o,"초"):"".concat(o,"초")},[T]),U=(0,s.useCallback)(function(e){if(!e.gameStartTime||"occupied"!==e.status)return 0;var t=T,r=Oe(e.gameStartTime),n=t.getTime()-r.getTime();n<0&&(n=0);var s=Math.floor(n/1e3),a=I.ratePerInterval,o=s/(60*I.timeInterval);return Math.floor(o)*a},[T,I]),F=function(e){switch(e){case"available":return"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30";case"occupied":return"bg-red-500/20 text-red-400 border border-red-500/30";case"maintenance":return"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30";default:return"bg-gray-500/20 text-gray-400 border border-gray-500/30"}},K=function(e){switch(e){case"available":return"이용 가능";case"occupied":return"사용 중";case"maintenance":return"점검 중";default:return"알 수 없음"}},q=function(e,t){return Le(void 0,void 0,void 0,function(){var r,n,s,a,o,l,c,u,m,x,p,g,y,v,b,j,N;return Ue(this,function(w){switch(w.label){case 0:if(!(null==S?void 0:S.email)||!(null==S?void 0:S.countryCode))return[2];w.label=1;case 1:return w.trys.push([1,3,,4]),r=h(S.email),n=f(S.countryCode),(s=Oe(e.gameStartTime))&&s instanceof Date&&!isNaN(s.getTime())?(a=Oe(t))&&a instanceof Date&&!isNaN(a.getTime())?(o=U(e),l=a.getTime()-s.getTime(),c=Math.floor(l/6e4),u=parseFloat((c/60).toFixed(2)),m=s.toLocaleDateString("ko-KR",{weekday:"long"}),x=s.getHours(),p=s.getMonth()+1,g=s.getFullYear(),y=0===s.getDay()||6===s.getDay(),v={id:"game_".concat(e.id,"_").concat(Date.now()),roomId:e.id,roomName:e.name,storeId:r,startTime:s.toLocaleString("ko-KR"),endTime:a?a.toLocaleString("ko-KR"):(new Date).toLocaleString("ko-KR"),usageMinutes:c,usageHours:u,totalFee:o,dayOfWeek:m,hourOfDay:x,month:p,year:g,isWeekend:y,createdAt:new Date},b=(0,i.rJ)(d,"settlements_".concat(n)),j=(0,i.H9)(b,v.id),[4,(0,i.BN)(j,v)]):(console.error("❌ Invalid endTime:",t),[2]):(console.error("❌ Invalid startTime:",e.gameStartTime),[2]);case 2:return w.sent(),console.log("🎮 GameRecord 생성 성공:",v),[3,4];case 3:return N=w.sent(),console.error("❌ GameRecord 생성 실패:",N),[3,4];case 4:return[2]}})})},_=function(){N({isOpen:!1,room:null,startTime:"",endTime:"",usageTime:"",totalFee:0})};return c?(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-400",children:"매장 정보를 불러오는 중..."})]})}):(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{className:"card-primary rounded-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h3",{className:"text-h2",children:"방 관리"}),(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsx)("button",{onClick:function(){var e=(null==t?void 0:t.email)?h(t.email):"";r("/dashboard?mode=store&storeId=".concat(e))},className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"대시보드",children:(0,n.jsx)(O.A,{className:"w-6 h-6"})})})]}),(0,n.jsxs)("div",{className:"border-t border-gray-700/50 pt-6",children:[(0,n.jsx)("h4",{className:"text-h3 mb-4",children:"매장 정보"}),(0,n.jsx)("div",{className:"card-secondary",children:(null==S?void 0:S.email)?(0,n.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"매장명"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:(null==S?void 0:S.storeName)||"기본 매장"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"관리자"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:(null==S?void 0:S.email)||"미설정"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"국가"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:"대한민국"===(null==S?void 0:S.country)?"대한민국":"United States"===(null==S?void 0:S.country)?"United States":(null==S?void 0:S.country)||"미설정"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"지역"}),(0,n.jsxs)("span",{className:"text-white font-medium mobile-text-sm",children:[(null==S?void 0:S.region)!==(null==S?void 0:S.country)?(null==S?void 0:S.region)||"미설정":""," ",(null==S?void 0:S.city)||""]})]})]}):(0,n.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"관리자"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:"미설정"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"국가"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:"미설정"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"지역"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:"미설정"})]})]})})]}),(0,n.jsxs)("div",{className:"border-t border-gray-700/50 pt-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,n.jsxs)("h4",{className:"text-h3",children:["방 목록 (",y.length,"개)"]})}),(0,n.jsx)("div",{className:"mobile-card-grid",children:y.map(function(e){return(0,n.jsxs)("div",{className:"card-secondary hover:border-gray-600/50 transition-all duration-300 hover:transform hover:scale-105",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("h5",{className:"text-h3 text-white mobile-text-sm",children:e.name})}),(0,n.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full touch-target ".concat(F(e.status)),children:K(e.status)})]}),(0,n.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{className:"text-body mobile-text-xs",children:["요금 (",I.timeInterval,"분당):"]}),(0,n.jsx)("span",{className:"text-primary mobile-text-sm",children:I.ratePerInterval.toLocaleString()})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"결제 요금:"}),(0,n.jsxs)("span",{className:"text-warning font-bold mobile-text-sm",children:["₩",U(e).toLocaleString()]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"시작 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:e.gameStartTime?Oe(e.gameStartTime).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"종료 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:"occupied"===e.status&&e.gameStartTime?(new Date).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"이용 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:L(e)})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:["available"===e.status&&(0,n.jsx)("button",{onClick:function(){return t=e.id,Le(void 0,void 0,void 0,function(){var e,r,n,s,a,o,l,c;return Ue(this,function(u){switch(u.label){case 0:if(!(null==S?void 0:S.email)||!(null==S?void 0:S.countryCode))return alert("로그인이 필요합니다."),[2];u.label=1;case 1:return u.trys.push([1,4,,5]),e=(0,i.H9)(d,"users_".concat(S.countryCode),S.email),[4,(0,i.x7)(e)];case 2:return(r=u.sent()).exists()?(n=r.data(),s=n.rooms||[],-1===(a=s.findIndex(function(e){return e.id===t}))?(alert("방을 찾을 수 없습니다."),[2]):(o=new Date,l=new Date(o.getTime()),P(o),s[a]=Pe(Pe({},s[a]),{status:"occupied",gameStartTime:l}),[4,(0,i.mZ)(e,{rooms:s})])):(alert("사용자 정보를 찾을 수 없습니다."),[2]);case 3:return u.sent(),console.log("게임 시작:",t),[3,5];case 4:return c=u.sent(),console.error("게임 시작 실패:",c),alert("게임 시작에 실패했습니다."),[3,5];case 5:return[2]}})});var t},className:"mobile-button touch-target",children:"시작"}),"occupied"===e.status&&(0,n.jsx)("button",{onClick:function(){return function(e){var t=L(e),r=U(e),n=e.gameStartTime?Oe(e.gameStartTime).toLocaleString("ko-KR"):"",s="occupied"===e.status&&e.gameStartTime?(new Date).toLocaleString("ko-KR"):"";N({isOpen:!0,room:e,startTime:n,endTime:s,usageTime:t,totalFee:r})}(e)},className:"mobile-button touch-target bg-gray-600 hover:bg-gray-700",children:"결제"})]})]},e.id)})})]})]}),x&&(0,n.jsx)("div",{className:"card-primary border-red-500/50 rounded-full",children:(0,n.jsx)("p",{className:"text-error",children:x})}),j.isOpen&&j.room&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:_,children:(0,n.jsxs)("div",{className:"card-primary w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto rounded-full",onClick:function(e){return e.stopPropagation()},children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h3",{className:"text-h2 mobile-text-sm",children:"결제 정보"}),(0,n.jsx)("button",{onClick:_,className:"text-gray-400 hover:text-white transition-colors touch-target p-2",children:(0,n.jsx)(M.A,{className:"icon-md"})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"방 이름:"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:(null===(e=j.room)||void 0===e?void 0:e.name)||""})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"시작 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:j.startTime})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"종료 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:j.endTime})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"이용 시간:"}),(0,n.jsx)("span",{className:"text-primary mobile-text-xs",children:j.usageTime})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"결제 요금:"}),(0,n.jsxs)("span",{className:"text-warning font-bold text-lg mobile-text-sm",children:["₩",j.totalFee.toLocaleString()]})]})]}),(0,n.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,n.jsx)("button",{onClick:_,className:"mobile-button touch-target bg-gray-600 hover:bg-gray-700 flex-1",children:"취소"}),(0,n.jsx)("button",{onClick:function(){return Le(void 0,void 0,void 0,function(){var e;return Ue(this,function(t){switch(t.label){case 0:if(!j.room)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(r=j.room.id,Le(void 0,void 0,void 0,function(){var e,t,n,s,a,o,l,c,u;return Ue(this,function(m){switch(m.label){case 0:if(!(null==S?void 0:S.email)||!(null==S?void 0:S.countryCode))return alert("로그인이 필요합니다."),[2];m.label=1;case 1:return m.trys.push([1,7,,8]),console.log("🎮 게임 종료 시작:",r),e=(0,i.H9)(d,"users_".concat(S.countryCode),S.email),[4,(0,i.x7)(e)];case 2:return(t=m.sent()).exists()?(n=t.data(),s=n.rooms||[],-1===(a=s.findIndex(function(e){return e.id===r}))?(alert("방을 찾을 수 없습니다."),[2]):(o=s[a],l=new Date,console.log("📝 방 정보:",o),console.log("⏰ 종료 시간:",l),"occupied"===o.status&&o.gameStartTime?(console.log("🎯 GameRecord 생성 시도..."),[4,q(o,l)]):[3,4])):(alert("사용자 정보를 찾을 수 없습니다."),[2]);case 3:return m.sent(),console.log("✅ GameRecord 생성 완료"),[3,5];case 4:console.warn("⚠️ GameRecord 생성 조건 불충족:",{status:o.status,hasStartTime:!!o.gameStartTime}),m.label=5;case 5:return o.gameStartTime,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}(o,["gameStartTime"]),s[a]=Pe(Pe({},c),{status:"available"}),console.log("💾 방 상태 업데이트:",s[a]),[4,(0,i.mZ)(e,{rooms:s})];case 6:return m.sent(),console.log("✅ 게임 종료 및 정산 완료:",r),alert("게임이 성공적으로 종료되었습니다."),[3,8];case 7:return u=m.sent(),console.error("❌ 게임 종료 실패:",u),console.error("❌ 에러 상세:",{message:null==u?void 0:u.message,code:null==u?void 0:u.code,stack:null==u?void 0:u.stack}),alert("게임 종료에 실패했습니다: ".concat((null==u?void 0:u.message)||"알 수 없는 오류")),[3,8];case 8:return[2]}})}))];case 2:return t.sent(),_(),alert("결제가 완료되었습니다."),[3,4];case 3:return e=t.sent(),console.error("결제 실패:",e),alert("결제에 실패했습니다."),[3,4];case 4:return[2]}var r})})},className:"mobile-button touch-target flex-1",children:"결제 완료"})]})]})})]})};var Ke=r(4266),Me=function(){return Me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Me.apply(this,arguments)},qe=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function o(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,l)}i((n=n.apply(e,t||[])).next())})},_e=function(e,t){var r,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}};const He=function(){var e=w().user,t=(0,s.useState)(5e3),r=t[0],a=t[1],o=(0,s.useState)(10),l=o[0],c=o[1],u=(0,s.useState)(5),m=u[0],x=u[1],h=(0,s.useState)(!1),f=h[0],p=h[1],g=(0,s.useState)(!1),y=g[0],v=g[1];return(0,s.useEffect)(function(){qe(void 0,void 0,void 0,function(){var t,r,n,s;return _e(this,function(o){switch(o.label){case 0:if(!(null==e?void 0:e.email)||!(null==e?void 0:e.countryCode))return[2];p(!0),o.label=1;case 1:return o.trys.push([1,3,4,5]),t=(0,i.H9)(d,"users_".concat(e.countryCode),e.email),[4,(0,i.x7)(t)];case 2:return(r=o.sent()).exists()?(n=r.data(),a(n.ratePerInterval||n.ratePer10Minutes||5e3),c(n.timeInterval||10),x(n.roomCount||5),console.log("사용자 설정 불러오기 성공:",n)):console.log("사용자 문서 없음, 기본값 사용"),[3,5];case 3:return s=o.sent(),console.error("설정 불러오기 실패:",s),[3,5];case 4:return p(!1),[7];case 5:return[2]}})})},[e]),f?(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsx)("h1",{className:"text-h1",children:"설정"}),(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"text-body",children:"설정을 불러오는 중..."})})]}):(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsx)("h1",{className:"text-h1",children:"설정"}),e&&(0,n.jsx)("div",{className:"card-secondary",children:(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"현재 사용자:"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:null==e?void 0:e.email})]}),(null==e?void 0:e.storeName)&&(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-body mobile-text-xs",children:"매장:"}),(0,n.jsx)("span",{className:"text-white font-medium mobile-text-sm",children:null==e?void 0:e.storeName})]})]})}),(0,n.jsx)("div",{className:"max-w-full",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[(0,n.jsx)("div",{className:"lg:col-span-1 xl:col-span-1",children:(0,n.jsxs)("div",{className:"card-primary h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center mb-6",children:[(0,n.jsx)("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-primary/20 rounded-full flex items-center justify-center mr-3 lg:mr-4",children:(0,n.jsx)(Ke.A,{className:"icon-md lg:icon-lg text-primary"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-h2 mobile-text-sm",children:"요금 설정"}),(0,n.jsx)("p",{className:"text-body text-xs lg:text-sm",children:"스크린골프 이용 요금을 설정합니다"})]})]}),(0,n.jsxs)("div",{className:"mobile-form flex-1 h-full",children:[(0,n.jsxs)("div",{className:"mobile-form-group",children:[(0,n.jsx)("label",{className:"mobile-form-label",children:"시간 간격 (분)"}),(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)("input",{type:"number",value:l,onChange:function(e){var t=parseInt(e.target.value)||1;c(t)},className:"mobile-form-input touch-target",placeholder:"시간 간격을 입력하세요",min:"1",max:"60",disabled:y}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400",children:"분"})]})})]}),(0,n.jsxs)("div",{className:"mobile-form-group",children:[(0,n.jsxs)("label",{className:"mobile-form-label",children:["요금 (",l,"분당)"]}),(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)("input",{type:"number",value:r,onChange:function(e){var t=parseInt(e.target.value)||0;a(t)},className:"mobile-form-input touch-target",placeholder:"요금을 입력하세요",min:"0",disabled:y}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400",children:"원"})]})}),(0,n.jsxs)("p",{className:"mt-2 text-xs lg:text-sm text-gray-400",children:[l,"분당 요금: ",r.toLocaleString(),"원"]})]})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4 mt-auto",children:[(0,n.jsx)("button",{onClick:function(){c(10),a(5e3)},className:"mobile-button touch-target bg-gray-600 hover:bg-gray-700 flex-1",disabled:y,children:"초기화"}),(0,n.jsx)("button",{onClick:function(){return qe(void 0,void 0,void 0,function(){var t,n,s,a,o,u,m,x;return _e(this,function(h){switch(h.label){case 0:if(!(null==e?void 0:e.email)||!(null==e?void 0:e.countryCode))return alert("로그인이 필요합니다."),[2];v(!0),h.label=1;case 1:return h.trys.push([1,4,5,6]),t=(0,i.H9)(d,"users_".concat(e.countryCode),e.email),[4,(0,i.x7)(t)];case 2:return n=h.sent(),s=[],n.exists()&&(a=n.data(),o=a.rooms||[],u=a.ratePerInterval||a.ratePer10Minutes||5e3,m=Math.round(60*u/l),s=o.map(function(e){return Me(Me({},e),{hourlyRate:m})}),console.log("시간 간격 변경: ".concat(l,"분당 ").concat(u,"원 → 시간당 ").concat(m,"원 (").concat(s.length,"개 방)"))),[4,(0,i.mZ)(t,{ratePerInterval:r,timeInterval:l,rooms:s,settingsUpdatedAt:(new Date).toISOString()})];case 3:return h.sent(),console.log("시간 간격 설정 저장 성공:",{timeInterval:l,email:e.email}),alert("✅ 시간 간격이 ".concat(l,"분으로 저장되었습니다.\n🏠 모든 방카드의 요금이 업데이트되었습니다.")),c(l),[3,6];case 4:return x=h.sent(),console.error("시간 간격 설정 저장 실패:",x),alert("❌ 시간 간격 설정 저장에 실패했습니다. 다시 시도해주세요."),[3,6];case 5:return v(!1),[7];case 6:return[2]}})})},className:"mobile-button touch-target flex-1",disabled:y||!e,children:y?"저장 중...":"저장"})]})]})}),(0,n.jsx)("div",{className:"lg:col-span-1 xl:col-span-1",children:(0,n.jsxs)("div",{className:"card-primary h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center mb-6",children:[(0,n.jsx)("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-secondary/20 rounded-full flex items-center justify-center mr-3 lg:mr-4",children:(0,n.jsx)(U.A,{className:"icon-md lg:icon-lg text-secondary"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-h2 mobile-text-sm",children:"방 갯수"}),(0,n.jsx)("p",{className:"text-body text-xs lg:text-sm",children:"생성할 방의 총 갯수를 설정합니다"})]})]}),(0,n.jsx)("div",{className:"mobile-form flex-1",children:(0,n.jsxs)("div",{className:"mobile-form-group",children:[(0,n.jsx)("label",{className:"mobile-form-label",children:"방 갯수"}),(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)("input",{type:"number",value:m,onChange:function(e){var t=parseInt(e.target.value)||1;x(Math.min(Math.max(t,1),20))},className:"mobile-form-input touch-target",placeholder:"방 갯수를 입력하세요",min:"1",max:"20",disabled:y}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400",children:"개"})]})}),(0,n.jsx)("p",{className:"mt-2 text-xs lg:text-sm text-gray-400",children:"생성할 방의 총 갯수 (1-20개)"})]})}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4 mt-auto",children:[(0,n.jsx)("button",{onClick:function(){x(5)},className:"mobile-button touch-target bg-gray-600 hover:bg-gray-700 flex-1",disabled:y,children:"초기화"}),(0,n.jsx)("button",{onClick:function(){return qe(void 0,void 0,void 0,function(){var t,r;return _e(this,function(n){switch(n.label){case 0:if(!(null==e?void 0:e.email)||!(null==e?void 0:e.countryCode))return alert("로그인이 필요합니다."),[2];v(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),t=(0,i.H9)(d,"users_".concat(e.countryCode),e.email),[4,(0,i.mZ)(t,{roomCount:m,settingsUpdatedAt:(new Date).toISOString()})];case 2:return n.sent(),console.log("방 갯수 설정 저장 성공:",{roomCount:m,email:e.email}),alert("✅ 방 갯수 ".concat(m,"개로 저장되었습니다.\n🏠 System 페이지로 이동하여 방카드를 확인합니다.")),window.location.href="/system",[3,5];case 3:return r=n.sent(),console.error("방 갯수 설정 저장 실패:",r),alert("❌ 방 갯수 설정 저장에 실패했습니다.\n다시 시도해주세요."),[3,5];case 4:return v(!1),[7];case 5:return[2]}})})},className:"mobile-button touch-target flex-1",disabled:y||!e,children:y?"저장 중...":"저장"})]})]})}),(0,n.jsx)("div",{className:"lg:col-span-1 xl:col-span-1",children:(0,n.jsxs)("div",{className:"card-primary h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center mb-6",children:[(0,n.jsx)("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-accent/20 rounded-full flex items-center justify-center mr-3 lg:mr-4",children:(0,n.jsx)(U.A,{className:"icon-md lg:icon-lg text-accent"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-h2 mobile-text-sm",children:"기타 설정"}),(0,n.jsx)("p",{className:"text-body text-xs lg:text-sm",children:"추가 설정 기능이 준비 중입니다"})]})]}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("p",{className:"text-gray-400 mobile-text-xs",children:"다른 설정 기능이 준비 중입니다..."})})]})})]})})]})};a.createRoot(document.getElementById("root")).render((0,n.jsx)(s.StrictMode,{children:(0,n.jsx)(function(){return(0,n.jsx)(C,{children:(0,n.jsx)(R,{children:(0,n.jsx)(I,{children:(0,n.jsx)(o.Kd,{children:(0,n.jsxs)(o.BV,{children:[(0,n.jsx)(o.qh,{path:"/",element:(0,n.jsx)(ye,{})}),(0,n.jsx)(o.qh,{path:"/login",element:(0,n.jsx)(pe,{})}),(0,n.jsx)(o.qh,{path:"/redirect",element:(0,n.jsx)(L,{})}),(0,n.jsx)(o.qh,{path:"/dashboard",element:(0,n.jsx)(P,{children:(0,n.jsx)(te,{children:(0,n.jsx)(we,{})})})}),(0,n.jsx)(o.qh,{path:"/storemanager",element:(0,n.jsx)(P,{requiredRole:"hq",children:(0,n.jsx)(te,{children:(0,n.jsx)(Te,{})})})}),(0,n.jsx)(o.qh,{path:"/system",element:(0,n.jsx)(P,{requiredRole:"store",children:(0,n.jsx)(te,{children:(0,n.jsx)(Fe,{})})})}),(0,n.jsx)(o.qh,{path:"/settings",element:(0,n.jsx)(P,{children:(0,n.jsx)(te,{children:(0,n.jsx)(He,{})})})})]})})})})})},{})}))}},e=>{e.O(0,[644,96],()=>e(e.s=800)),e.O()}]);
//# sourceMappingURL=main.9af4b3e18f3ccc06c7a9.js.map